import tkinter as tk
from tkinter import ttk
import matplotlib
import numpy as np


matplotlib.use('TkAgg')
from matplotlib.backends.backend_tkagg import FigureCanvasTkAgg, NavigationToolbar2TkAgg
from matplotlib.figure import Figure


SMALL_FONT = ('Verdana', 8)
LARGE_FONT = ('Verdana', 12)


def rYieldFunc(t, Nutrient, yConsts):
    a = yConsts[0]
    k1 = yConsts[1]
    k2 = yConsts[2]
    Yield = a * (k1 + Nutrient) / (k2 + Nutrient)
    return Yield.clip(max=100)



def sh1(TObs, Obs, t, pk, P0, alpha, c):
    popup = tk.Tk()
    popup.wm_title('Phosphorous parametrisation')
    frame = ttk.Frame(popup)
    frame.grid(row=0,column=0,padx=(20,0),pady=20)
    frame1=ttk.Frame(popup)
    frame1.grid(row=0,column=1, padx=(0,20), pady=20, sticky='n')
    parLab = ttk.LabelFrame(frame1,text='The resultant parameters:')
    parLab.grid(row=0, column=0, padx=20, pady=20,sticky='ew')
    lblOne = tk.Text(parLab, width=4,height=1,background='snow2')
    lblOne.insert(tk.INSERT,'P0 =')
    lblOne.tag_add('pn','1.0','1.1')
    lblOne.tag_add('pn1','1.2','1.4')
    lblOne.tag_add("psub",'1.1','1.2')
    lblOne.tag_configure("psub",offset=-2.3,font=SMALL_FONT)
    lblOne.tag_configure('pn',font=LARGE_FONT)
    lblOne.tag_configure('pn1',font=LARGE_FONT)
    lblOne.configure(state=tk.DISABLED,borderwidth=-3)
    lblOne.grid(row=0, column=0, padx=5, pady=5)

    lblOneAns = tk.Text(parLab, width=13,height=1)
    lblOneAns.insert(tk.INSERT,str(round(P0,2)))
    lblOneAns.configure(state=tk.DISABLED)
    lblOneAns.grid(row=0, column=1, padx=5, pady=5)

    lblOneUnit = tk.Text(parLab, width=20,height=1,background='snow2')
    lblOneUnit.insert(tk.INSERT, u'\N{GREEK SMALL LETTER MU}g P cm-3')
    lblOneUnit.tag_add("pun",'1.0','1.7')
    lblOneUnit.tag_add("pusub",'1.7','1.9')
    lblOneUnit.tag_configure("pun",font=LARGE_FONT)
    lblOneUnit.tag_configure("pusub",offset=2.3,font=SMALL_FONT)
    lblOneUnit.configure(state=tk.DISABLED,borderwidth=-3)
    lblOneUnit.grid(row=0, column=2, padx=5, pady=5)

    alphaPLab = tk.Text(parLab, width=4,height=1,background='snow2')
    alphaPLab.grid(row=1,column=0,pady=5,padx=5)
    alphaPLab.insert(tk.INSERT,u'\N{GREEK SMALL LETTER ALPHA}')
    alphaPLab.insert(tk.END,"p =")
    alphaPLab.tag_add("pan",'1.0','1.1')
    alphaPLab.tag_add("subscript",'1.1','1.2')
    alphaPLab.tag_add("pan1",'1.0','1.1')
    alphaPLab.tag_add("main",'1.2','1.4')
    alphaPLab.tag_configure("pan",font=LARGE_FONT)
    alphaPLab.tag_configure("subscript",offset=-2.3,font=SMALL_FONT)
    alphaPLab.tag_configure("pan1",font=LARGE_FONT)
    alphaPLab.tag_configure("main",font=LARGE_FONT)
    alphaPLab.configure(state=tk.DISABLED, borderwidth=-3)

        
    alphaPText = tk.Text(parLab, width=13, height=1)
    alphaPText.grid(row=1,column=1,padx=5,pady=5)
    alphaPText.insert(tk.INSERT,'{0:.4f}'.format(alpha*10**4)+' x 10-4')
    alphaPText.tag_add('a','1.11','1.13')
    alphaPText.tag_configure('a',offset=2.3,font=SMALL_FONT)
    alphaPText.configure(state=tk.DISABLED)

    alphaPLabUnit = tk.Text(parLab, width=20,height=1,background='snow2')
    alphaPLabUnit.grid(row=1,column=2,pady=5,padx=5)
    alphaPLabUnit.insert(tk.INSERT,'day-1')
    alphaPLabUnit.tag_add("paun",'1.0','1.3')
    alphaPLabUnit.tag_add("superscript",'1.3','1.5')
    alphaPLabUnit.tag_configure("paun",font=LARGE_FONT)
    alphaPLabUnit.tag_configure("superscript",offset=2.3,font=SMALL_FONT)
    
    alphaPLabUnit.configure(state=tk.DISABLED, borderwidth=-3)


    lblThree = tk.Text(parLab, width=4,height=1,background='snow2')
    lblThree.insert(tk.INSERT,'cp =')
    lblThree.tag_add("cpn",'1.0','1.1')
    lblThree.tag_add("csub",'1.1','1.2')
    lblThree.tag_add("cpn1",'1.2','1.4')
    lblThree.tag_configure("cpn",font=LARGE_FONT)
    lblThree.tag_configure("csub",offset=-2.3,font=SMALL_FONT)
    lblThree.tag_configure("cpn1",font=LARGE_FONT)
    lblThree.configure(state=tk.DISABLED,borderwidth=-3)
    lblThree.grid(row=2, column=0, padx=5, pady=5)

    
    lblThreeAns = tk.Text(parLab, width=13,height=1)
    lblThreeAns.insert(tk.INSERT,str(round(c,4)))
    lblThreeAns.configure(state=tk.DISABLED)
    lblThreeAns.grid(row=2, column=1, padx=5, pady=5)

    lblThreeUnit = tk.Text(parLab, width=20,height=1,background='snow2')
    lblThreeUnit.insert(tk.INSERT, 'Olsen P (kg P ha-1)-1')
    lblThreeUnit.tag_add("cupn",'1.0','1.16')
    lblThreeUnit.tag_add("cusup1",'1.16','1.18')
    lblThreeUnit.tag_add("cupn1",'1.18','1.19')
    lblThreeUnit.tag_add("cusup2",'1.19','1.21')
    lblThreeUnit.tag_configure("cupn",font=LARGE_FONT)
    lblThreeUnit.tag_configure("cusup1",offset=2.3,font=SMALL_FONT)
    lblThreeUnit.tag_configure("cupn1",font=LARGE_FONT)
    lblThreeUnit.tag_configure("cusup2",offset=2.3,font=SMALL_FONT)
    lblThreeUnit.configure(state=tk.DISABLED,borderwidth=-3)
    lblThreeUnit.grid(row=2, column=2, padx=5, pady=5)

    ryLab = ttk.LabelFrame(frame1,text='RY parameters:')
    ryLab.grid(row=1, column=0, padx=20, pady=20,sticky='ew')

    rygpLab = ttk.Label(ryLab, text='Soil Group')
    rygpLab.grid(row=0, column=0, padx=10,pady=10,sticky='e')

    rygpVar = tk.StringVar()
    rygpEnt = ttk.Combobox(ryLab, textvariable=rygpVar, width=10, state='readonly')
    rygpEnt['values'] = ['Sedimentary', 'Volcanic', 'Pumice', 'Recent', 'Podzols','Sands']
    rygpEnt.current(0)
    rygpEnt.grid(row=0, column=1, padx=10, pady=10)

    def plotRY():
        if rygpEnt.get() == 'Sedimentary':
            ryConsts = np.array((104.61,0,2.60),dtype=float)
        elif rygpEnt.get() == 'Volcanic':
            ryConsts = np.array((108.60,10.44,17.22),dtype=float)
        elif rygpEnt.get() == 'Pumice':
            ryConsts = np.array((106.60,15.52,23.41),dtype=float)
        elif rygpEnt.get() == 'Recent':
            ryConsts = np.array((105.00,28.49,34.75),dtype=float)
        elif rygpEnt.get() == 'Podzols':
            ryConsts = np.array((199.91,107.42,255.51),dtype=float)
        elif rygpEnt.get() == 'Sands':
            ryConsts = np.array((105.48,0.00,1.40),dtype=float)

        ry = rYieldFunc(t,pk,ryConsts)
        b.plot(t/365,ry,'r')
        canvas = FigureCanvasTkAgg(fig, frame)
        canvas.show()
        canvas.get_tk_widget().grid(row=0, column=0, columnspan=1, padx=10, pady=10, sticky='nsew')

    ryBtn = tk.Button(ryLab, text='Plot RY', command=plotRY)
    ryBtn.grid(row=0, column=2, padx=10,pady=10)
    
    fig = Figure(figsize=(5,6), dpi=80)
    a = fig.add_subplot(211)
    a.axis([TObs[0]/365, TObs[-1]/365 + 0.5, 0, max(max(Obs),max(pk)) + 5])
    a.xaxis.set_major_formatter(matplotlib.ticker.FormatStrFormatter('%.0f'))
    a.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=True))
    a.set_ylabel('Olsen P')
    b = fig.add_subplot(212)
    b.axis([TObs[0]/365, TObs[-1]/365 + 0.5, 50, 105])
    b.xaxis.set_major_formatter(matplotlib.ticker.FormatStrFormatter('%.0f'))
    b.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=True))
    b.set_ylabel('RY')
    b.set_xlabel('Years')
            
    a.plot(t/365, pk, 'r', TObs/365, Obs, 'r^')
    canvas = FigureCanvasTkAgg(fig, frame)
    canvas.show()
    canvas.get_tk_widget().grid(row=0, column=0, columnspan=1, padx=10, pady=10, sticky='nsew')
    popup.mainloop()

def sh1k(TObs, Obs, t, pk, K0, alpha, c):
    popup = tk.Tk()
    popup.wm_title('Potassium parametrisation')
    frame = ttk.Frame(popup)
    frame.grid(row=0,column=0,padx=(20,0),pady=20)
    frame1=ttk.Frame(popup)
    frame1.grid(row=0,column=1, padx=(0,20), pady=20, sticky='n')
    parLab = ttk.LabelFrame(frame1,text='The resultant parameters:')
    parLab.grid(row=0, column=0, padx=20, pady=20,sticky='ew')

    lblOne = tk.Text(parLab, width=4,height=1,background='snow2')
    lblOne.insert(tk.INSERT,'K0 =')
    lblOne.tag_add("kn",'1.0','1.1')
    lblOne.tag_add("ksub",'1.1','1.2')
    lblOne.tag_add("kn1",'1.2','1.4')
    lblOne.tag_configure("kn",font=LARGE_FONT)
    lblOne.tag_configure("ksub",offset=-2.3,font=SMALL_FONT)
    lblOne.tag_configure("kn1",font=LARGE_FONT)
    lblOne.configure(state=tk.DISABLED,borderwidth=-3)
    lblOne.grid(row=0, column=0, padx=5, pady=5)

    lblOneAns = tk.Text(parLab, width=13,height=1)
    lblOneAns.insert(tk.INSERT,str(round(K0,2)))
    lblOneAns.configure(state=tk.DISABLED)
    lblOneAns.grid(row=0, column=1, padx=5, pady=5)

    lblOneUnit = tk.Text(parLab, width=21,height=1,background='snow2')
    lblOneUnit.insert(tk.INSERT, 'cmol(+) kg-1 x 24.375')
    lblOneUnit.tag_add("kun",'1.0','1.10')
    lblOneUnit.tag_add("kusup",'1.10','1.12')
    lblOneUnit.tag_add("kun1",'1.12','1.21')
    lblOneUnit.tag_configure("kun",font=LARGE_FONT)
    lblOneUnit.tag_configure("kusup",offset=2.3,font=SMALL_FONT)
    lblOneUnit.tag_configure("kun1",font=LARGE_FONT)
    lblOneUnit.configure(state=tk.DISABLED,borderwidth=-3)
    lblOneUnit.grid(row=0, column=2, padx=5, pady=5)

    alphaPLab = tk.Text(parLab, width=4,height=1,background='snow2')
    alphaPLab.grid(row=1,column=0,pady=5,padx=5)
    alphaPLab.insert(tk.INSERT,u'\N{GREEK SMALL LETTER ALPHA}')
    alphaPLab.insert(tk.END,"k =")
    alphaPLab.tag_add("kan",'1.0','1.1')
    alphaPLab.tag_add("subscript",'1.1','1.2')
    alphaPLab.tag_add("kan1",'1.2','1.4')
    alphaPLab.tag_configure("kan",font=LARGE_FONT)
    alphaPLab.tag_configure("subscript",offset=-2.3,font=SMALL_FONT)
    alphaPLab.tag_configure("kan1",font=LARGE_FONT)
    alphaPLab.configure(state=tk.DISABLED, borderwidth=-3)

        
    alphaPText = tk.Text(parLab, width=13, height=1)
    alphaPText.grid(row=1,column=1,padx=5,pady=5)
    alphaPText.insert(tk.INSERT,'{0:.4f}'.format(alpha*10**4)+' x 10-4')
    alphaPText.tag_add('a','1.11','1.13')
    alphaPText.tag_configure('a',offset=2.3,font=SMALL_FONT)
    alphaPText.configure(state=tk.DISABLED)

    alphaPLabUnit = tk.Text(parLab, width=21,height=1,background='snow2')
    alphaPLabUnit.grid(row=1,column=2,pady=5,padx=5)
    alphaPLabUnit.insert(tk.INSERT,'day-1')
    alphaPLabUnit.tag_add("kaun",'1.0','1.3')
    alphaPLabUnit.tag_add("superscript",'1.3','1.5')
    alphaPLabUnit.tag_configure("kaun",font=LARGE_FONT)
    alphaPLabUnit.tag_configure("superscript",offset=2.3,font=SMALL_FONT)
    alphaPLabUnit.configure(state=tk.DISABLED, borderwidth=-3)


    lblThree = tk.Text(parLab, width=4,height=1,background='snow2')
    lblThree.insert(tk.INSERT,'ck =')
    lblThree.tag_add("ckn",'1.0','1.1')
    lblThree.tag_add("csub",'1.1','1.2')
    lblThree.tag_add("ckn1",'1.2','1.4')
    lblThree.tag_configure("ckn",font=LARGE_FONT)
    lblThree.tag_configure("csub",offset=-2.3,font=SMALL_FONT)
    lblThree.tag_configure("ckn1",font=LARGE_FONT)
    lblThree.configure(state=tk.DISABLED,borderwidth=-3)
    lblThree.grid(row=2, column=0, padx=5, pady=5)

    
    lblThreeAns = tk.Text(parLab, width=13,height=1)
    lblThreeAns.insert(tk.INSERT,str(round(c,4)))
    lblThreeAns.configure(state=tk.DISABLED)
    lblThreeAns.grid(row=2, column=1, padx=5, pady=5)

    lblThreeUnit = tk.Text(parLab, width=21,height=1,background='snow2')
    lblThreeUnit.insert(tk.INSERT, 'QTK (kg K ha-1)-1')
    lblThreeUnit.tag_add("cukn",'1.0','1.12')
    lblThreeUnit.tag_add("cusup1",'1.12','1.14')
    lblThreeUnit.tag_add("cukn1",'1.14','1.15')
    lblThreeUnit.tag_add("cusup2",'1.15','1.17')
    lblThreeUnit.tag_configure("cukn",font=LARGE_FONT)
    lblThreeUnit.tag_configure("cusup1",offset=2.3,font=SMALL_FONT)
    lblThreeUnit.tag_configure("cukn1",font=LARGE_FONT)
    lblThreeUnit.tag_configure("cusup2",offset=2.3,font=SMALL_FONT)
    lblThreeUnit.configure(state=tk.DISABLED,borderwidth=-3)
    lblThreeUnit.grid(row=2, column=2, padx=5, pady=5)

    
    ryKConsts = np.array([125.09, 4.24, 7.84])
    

    
    fig = Figure(figsize=(5,6), dpi=80)
    a = fig.add_subplot(211)
    a.axis([TObs[0]/365, TObs[-1]/365 + 0.5, 0, max(max(Obs),max(pk)) + 5])
    a.xaxis.set_major_formatter(matplotlib.ticker.FormatStrFormatter('%.0f'))
    a.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=True))
    a.set_ylabel('QTK')
    b = fig.add_subplot(212)
    b.axis([TObs[0]/365, TObs[-1]/365 + 0.5, 50, 105])
    b.xaxis.set_major_formatter(matplotlib.ticker.FormatStrFormatter('%.0f'))
    b.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=True))
    b.set_ylabel('RY')
    b.set_xlabel('Years')
            
    a.plot(t/365, pk, 'r', TObs/365, Obs, 'r^')
    ry = rYieldFunc(t,pk,ryKConsts)
    b.plot(t/365,ry,'r')
    canvas = FigureCanvasTkAgg(fig, frame)
    canvas.show()
    canvas.get_tk_widget().grid(row=0, column=0, columnspan=1, padx=10, pady=10, sticky='nsew')
    popup.mainloop()

def sh1s(TObs, Obs, t, pk, S0, alpha, c):
    popup = tk.Tk()
    popup.wm_title('Sulphur parametrisation')
    frame = ttk.Frame(popup)
    frame.grid(row=0,column=0,padx=(20,0),pady=20)
    frame1=ttk.Frame(popup)
    frame1.grid(row=0,column=1, padx=(0,20), pady=20, sticky='n')
    parLab = ttk.LabelFrame(frame1,text='The resultant parameters:')
    parLab.grid(row=0, column=0, padx=20, pady=20,sticky='ew')

    lblOne = tk.Text(parLab, width=4,height=1,background='snow2')
    lblOne.insert(tk.INSERT,'S0 =')
    lblOne.tag_add("sn",'1.0','1.1')
    lblOne.tag_add("ssub",'1.1','1.2')
    lblOne.tag_add("sn1",'1.2','1.4')
    lblOne.tag_configure("sn",font=LARGE_FONT)
    lblOne.tag_configure("ssub",offset=-2.3,font=SMALL_FONT)
    lblOne.tag_configure("sn1",font=LARGE_FONT)
    lblOne.configure(state=tk.DISABLED,borderwidth=-3)
    lblOne.grid(row=0, column=0, padx=5, pady=5)

    lblOneAns = tk.Text(parLab, width=13,height=1)
    lblOneAns.insert(tk.INSERT,str(round(S0,2)))
    lblOneAns.configure(state=tk.DISABLED)
    lblOneAns.grid(row=0, column=1, padx=5, pady=5)

    lblOneUnit = tk.Text(parLab, width=21,height=1,background='snow2')
    lblOneUnit.insert(tk.INSERT, u'\N{GREEK SMALL LETTER MU}g S g-1')
    lblOneUnit.tag_add("sun",'1.0','1.6')
    lblOneUnit.tag_add("susup",'1.6','1.8')
    lblOneUnit.tag_configure("sun",font=LARGE_FONT)
    lblOneUnit.tag_configure("susup",offset=2.3,font=SMALL_FONT)
    lblOneUnit.configure(state=tk.DISABLED,borderwidth=-3)
    lblOneUnit.grid(row=0, column=2, padx=5, pady=5)

    alphaPLab = tk.Text(parLab, width=4,height=1,background='snow2')
    alphaPLab.grid(row=1,column=0,pady=5,padx=5)
    alphaPLab.insert(tk.INSERT,u'\N{GREEK SMALL LETTER ALPHA}')
    alphaPLab.insert(tk.END,"s =")
    alphaPLab.tag_add("san",'1.0','1.1')
    alphaPLab.tag_add("subscript",'1.1','1.2')
    alphaPLab.tag_add("san1",'1.2','1.4')
    alphaPLab.tag_configure("san",font=LARGE_FONT)
    alphaPLab.tag_configure("subscript",offset=-2.3,font=SMALL_FONT)
    alphaPLab.tag_configure("san1",font=LARGE_FONT)
    alphaPLab.configure(state=tk.DISABLED, borderwidth=-3)

        
    alphaPText = tk.Text(parLab, width=13, height=1)
    alphaPText.grid(row=1,column=1,padx=5,pady=5)
    alphaPText.insert(tk.INSERT,'{0:.4f}'.format(alpha*10**4)+' x 10-4')
    alphaPText.tag_add('a','1.11','1.13')
    alphaPText.tag_configure('a',offset=2.3,font=SMALL_FONT)
    alphaPText.configure(state=tk.DISABLED)

    alphaPLabUnit = tk.Text(parLab, width=21,height=1,background='snow2')
    alphaPLabUnit.grid(row=1,column=2,pady=5,padx=5)
    alphaPLabUnit.insert(tk.INSERT,'day-1')
    alphaPLabUnit.tag_add("saun",'1.0','1.3')
    alphaPLabUnit.tag_add("superscript",'1.3','1.5')
    alphaPLabUnit.tag_configure("saun",font=LARGE_FONT)
    alphaPLabUnit.tag_configure("superscript",offset=2.3,font=SMALL_FONT)
    alphaPLabUnit.configure(state=tk.DISABLED, borderwidth=-3)


    lblThree = tk.Text(parLab, width=4,height=1,background='snow2')
    lblThree.insert(tk.INSERT,'cs =')
    lblThree.tag_add("csn",'1.0','1.1')
    lblThree.tag_add("csub",'1.1','1.2')
    lblThree.tag_add("csn1",'1.2','1.4')
    lblThree.tag_configure("csn",font=LARGE_FONT)
    lblThree.tag_configure("csub",offset=-2.3,font=SMALL_FONT)
    lblThree.tag_configure("csn1",font=LARGE_FONT)
    lblThree.configure(state=tk.DISABLED,borderwidth=-3)
    lblThree.grid(row=2, column=0, padx=5, pady=5)

    
    lblThreeAns = tk.Text(parLab, width=13,height=1)
    lblThreeAns.insert(tk.INSERT,str(round(c,4)))
    lblThreeAns.configure(state=tk.DISABLED)
    lblThreeAns.grid(row=2, column=1, padx=5, pady=5)

    lblThreeUnit = tk.Text(parLab, width=21,height=1,background='snow2')
    lblThreeUnit.insert(tk.INSERT, 'EOS (kg S ha-1)-1')
    lblThreeUnit.tag_add("cusn",'1.0','1.12')
    lblThreeUnit.tag_add("cusup1",'1.12','1.14')
    lblThreeUnit.tag_add("cusn1",'1.14','1.15')
    lblThreeUnit.tag_add("cusup2",'1.15','1.17')
    lblThreeUnit.tag_configure("cusn",font=LARGE_FONT)
    lblThreeUnit.tag_configure("cusup1",offset=2.3,font=SMALL_FONT)
    lblThreeUnit.tag_configure("cusn1",font=LARGE_FONT)
    lblThreeUnit.tag_configure("cusup2",offset=2.3,font=SMALL_FONT)
    lblThreeUnit.configure(state=tk.DISABLED,borderwidth=-3)
    lblThreeUnit.grid(row=2, column=2, padx=5, pady=5)

    
    rySConsts = np.array([183.80, 0.09, 10.49])
    

    
    fig = Figure(figsize=(5,6), dpi=80)
    a = fig.add_subplot(211)
    a.axis([TObs[0]/365, TObs[-1]/365 + 0.5, 0, max(max(Obs),max(pk)) + 5])
    a.xaxis.set_major_formatter(matplotlib.ticker.FormatStrFormatter('%.0f'))
    a.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=True))
    a.set_ylabel('EOS')
    b = fig.add_subplot(212)
    b.axis([TObs[0]/365, TObs[-1]/365 + 0.5, 50, 105])
    b.xaxis.set_major_formatter(matplotlib.ticker.FormatStrFormatter('%.0f'))
    b.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=True))
    b.set_ylabel('RY')
    b.set_xlabel('Years')
            
    a.plot(t/365, pk, 'r', TObs/365, Obs, 'r^')
    ry = rYieldFunc(t,pk,rySConsts)
    b.plot(t/365,ry,'r')
    canvas = FigureCanvasTkAgg(fig, frame)
    canvas.show()
    canvas.get_tk_widget().grid(row=0, column=0, columnspan=1, padx=10, pady=10, sticky='nsew')
    popup.mainloop()


def sh2(TObs, Obs1, Obs2, t, pk1, pk2, P0, alpha, c):
    popup = tk.Tk()
    popup.wm_title('Phosphorous parametrization')
    frame = ttk.Frame(popup)
    frame.grid(row=0,column=0,padx=(20,0),pady=20)
    frame1=ttk.Frame(popup)
    frame1.grid(row=0,column=1, padx=(0,20), pady=20, sticky='n')
    parLab = ttk.LabelFrame(frame1,text='The resultant parameters:')
    parLab.grid(row=0, column=0, padx=20, pady=20,sticky='ew')

    lblOne = tk.Text(parLab, width=4,height=1,background='snow2')
    lblOne.insert(tk.INSERT,'P0 =')
    lblOne.tag_add('pn','1.0','1.1')
    lblOne.tag_add('pn1','1.2','1.4')
    lblOne.tag_add("psub",'1.1','1.2')
    lblOne.tag_configure("psub",offset=-2.3,font=SMALL_FONT)
    lblOne.tag_configure('pn',font=LARGE_FONT)
    lblOne.tag_configure('pn1',font=LARGE_FONT)
    lblOne.configure(state=tk.DISABLED,borderwidth=-3)
    lblOne.grid(row=0, column=0, padx=5, pady=5)

    lblOneAns = tk.Text(parLab, width=13,height=1)
    lblOneAns.insert(tk.INSERT,str(round(P0,2)))
    lblOneAns.configure(state=tk.DISABLED)
    lblOneAns.grid(row=0, column=1, padx=5, pady=5)

    lblOneUnit = tk.Text(parLab, width=20,height=1,background='snow2')
    lblOneUnit.insert(tk.INSERT, u'\N{GREEK SMALL LETTER MU}g P cm-3')
    lblOneUnit.tag_add("pun",'1.0','1.7')
    lblOneUnit.tag_add("pusub",'1.7','1.9')
    lblOneUnit.tag_configure("pun",font=LARGE_FONT)
    lblOneUnit.tag_configure("pusub",offset=2.3,font=SMALL_FONT)
    lblOneUnit.configure(state=tk.DISABLED,borderwidth=-3)
    lblOneUnit.grid(row=0, column=2, padx=5, pady=5)

    alphaPLab = tk.Text(parLab, width=4,height=1,background='snow2')
    alphaPLab.grid(row=1,column=0,pady=5,padx=5)
    alphaPLab.insert(tk.INSERT,u'\N{GREEK SMALL LETTER ALPHA}')
    alphaPLab.insert(tk.END,"p =")
    alphaPLab.tag_add("pan",'1.0','1.1')
    alphaPLab.tag_add("subscript",'1.1','1.2')
    alphaPLab.tag_add("pan1",'1.0','1.1')
    alphaPLab.tag_add("main",'1.2','1.4')
    alphaPLab.tag_configure("pan",font=LARGE_FONT)
    alphaPLab.tag_configure("subscript",offset=-2.3,font=SMALL_FONT)
    alphaPLab.tag_configure("pan1",font=LARGE_FONT)
    alphaPLab.tag_configure("main",font=LARGE_FONT)
    alphaPLab.configure(state=tk.DISABLED, borderwidth=-3)

        
    alphaPText = tk.Text(parLab, width=13, height=1)
    alphaPText.grid(row=1,column=1,padx=5,pady=5)
    alphaPText.insert(tk.INSERT,'{0:.4f}'.format(alpha*10**4)+' x 10-4')
    alphaPText.tag_add('a','1.11','1.13')
    alphaPText.tag_configure('a',offset=2.3,font=SMALL_FONT)
    alphaPText.configure(state=tk.DISABLED)

    alphaPLabUnit = tk.Text(parLab, width=20,height=1,background='snow2')
    alphaPLabUnit.grid(row=1,column=2,pady=5,padx=5)
    alphaPLabUnit.insert(tk.INSERT,'day-1')
    alphaPLabUnit.tag_add("paun",'1.0','1.3')
    alphaPLabUnit.tag_add("superscript",'1.3','1.5')
    alphaPLabUnit.tag_configure("paun",font=LARGE_FONT)
    alphaPLabUnit.tag_configure("superscript",offset=2.3,font=SMALL_FONT)
    
    alphaPLabUnit.configure(state=tk.DISABLED, borderwidth=-3)


    lblThree = tk.Text(parLab, width=4,height=1,background='snow2')
    lblThree.insert(tk.INSERT,'cp =')
    lblThree.tag_add("cpn",'1.0','1.1')
    lblThree.tag_add("csub",'1.1','1.2')
    lblThree.tag_add("cpn1",'1.2','1.4')
    lblThree.tag_configure("cpn",font=LARGE_FONT)
    lblThree.tag_configure("csub",offset=-2.3,font=SMALL_FONT)
    lblThree.tag_configure("cpn1",font=LARGE_FONT)
    lblThree.configure(state=tk.DISABLED,borderwidth=-3)
    lblThree.grid(row=2, column=0, padx=5, pady=5)

    
    lblThreeAns = tk.Text(parLab, width=13,height=1)
    lblThreeAns.insert(tk.INSERT,str(round(c,4)))
    lblThreeAns.configure(state=tk.DISABLED)
    lblThreeAns.grid(row=2, column=1, padx=5, pady=5)

    lblThreeUnit = tk.Text(parLab, width=20,height=1,background='snow2')
    lblThreeUnit.insert(tk.INSERT, 'Olsen P (kg P ha-1)-1')
    lblThreeUnit.tag_add("cupn",'1.0','1.16')
    lblThreeUnit.tag_add("cusup1",'1.16','1.18')
    lblThreeUnit.tag_add("cupn1",'1.18','1.19')
    lblThreeUnit.tag_add("cusup2",'1.19','1.21')
    lblThreeUnit.tag_configure("cupn",font=LARGE_FONT)
    lblThreeUnit.tag_configure("cusup1",offset=2.3,font=SMALL_FONT)
    lblThreeUnit.tag_configure("cupn1",font=LARGE_FONT)
    lblThreeUnit.tag_configure("cusup2",offset=2.3,font=SMALL_FONT)
    lblThreeUnit.configure(state=tk.DISABLED,borderwidth=-3)
    lblThreeUnit.grid(row=2, column=2, padx=5, pady=5)


    ryLab = ttk.LabelFrame(frame1,text='The resultant parameters:')
    ryLab.grid(row=1, column=0, padx=20, pady=20,sticky='ew')

    rygpLab = ttk.Label(ryLab, text='Soil Group')
    rygpLab.grid(row=0, column=0, padx=10,pady=10,sticky='e')

    rygpVar = tk.StringVar()
    rygpEnt = ttk.Combobox(ryLab, textvariable=rygpVar, width=10, state='readonly')
    rygpEnt['values'] = ['Sedimentary', 'Volcanic', 'Pumice', 'Recent', 'Podzols','Sands']
    rygpEnt.current(0)
    rygpEnt.grid(row=0, column=1, padx=10, pady=10)



    def plotRY():
        if rygpEnt.get() == 'Sedimentary':
            ryConsts = np.array((104.61,0,2.60),dtype=float)
        elif rygpEnt.get() == 'Volcanic':
            ryConsts = np.array((108.60,10.44,17.22),dtype=float)
        elif rygpEnt.get() == 'Pumice':
            ryConsts = np.array((106.60,15.52,23.41),dtype=float)
        elif rygpEnt.get() == 'Recent':
            ryConsts = np.array((105.00,28.49,34.75),dtype=float)
        elif rygpEnt.get() == 'Podzols':
            ryConsts = np.array((199.91,107.42,255.51),dtype=float)
        elif rygpEnt.get() == 'Sands':
            ryConsts = np.array((105.48,0.00,1.40),dtype=float)

        ry1 = rYieldFunc(t,pk1,ryConsts)
        ry2 = rYieldFunc(t,pk2,ryConsts)
        b.plot(t/365,ry1,'r',t/365,ry2,'b')
        canvas = FigureCanvasTkAgg(fig, frame)
        canvas.show()
        canvas.get_tk_widget().grid(row=0, column=0, columnspan=1, padx=10, pady=10, sticky='nsew')

    ryBtn = tk.Button(ryLab, text='Plot RY', command=plotRY)
    ryBtn.grid(row=0, column=2, padx=10,pady=10)
    
    fig = Figure(figsize=(5,6), dpi=80)
    a = fig.add_subplot(211)
    a.axis([TObs[0]/365, TObs[-1]/365 + 0.5, 0, max(max(Obs1),max(Obs2),max(pk2))+5])
    a.xaxis.set_major_formatter(matplotlib.ticker.FormatStrFormatter('%.0f'))
    a.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=True))
    a.set_ylabel('Olsen P')
    b = fig.add_subplot(212)
    b.axis([TObs[0]/365, TObs[-1]/365 + 0.5, 50, 105])
    b.xaxis.set_major_formatter(matplotlib.ticker.FormatStrFormatter('%.0f'))
    b.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=True))
    b.set_ylabel('RY')
    b.set_xlabel('Years')
            
    a.plot(t/365, pk1, 'r', TObs/365, Obs1, 'r^', t/365, pk2, 'b', TObs/365, Obs2, 'b^')
    canvas = FigureCanvasTkAgg(fig, frame)
    canvas.show()
    canvas.get_tk_widget().grid(row=0, column=0, columnspan=1, padx=10, pady=10, sticky='nsew')
    popup.mainloop()
    

def sh2k(TObs, Obs1, Obs2,t, pk1,pk2, K0, alpha, c):
    popup = tk.Tk()
    popup.wm_title('Potassium parametrisation')
    frame = ttk.Frame(popup)
    frame.grid(row=0,column=0,padx=(20,0),pady=20)
    frame1=ttk.Frame(popup)
    frame1.grid(row=0,column=1, padx=(0,20), pady=20, sticky='n')
    parLab = ttk.LabelFrame(frame1,text='The resultant parameters:')
    parLab.grid(row=0, column=0, padx=20, pady=20,sticky='ew')

    lblOne = tk.Text(parLab, width=4,height=1,background='snow2')
    lblOne.insert(tk.INSERT,'K0 =')
    lblOne.tag_add("kn",'1.0','1.1')
    lblOne.tag_add("ksub",'1.1','1.2')
    lblOne.tag_add("kn1",'1.2','1.4')
    lblOne.tag_configure("kn",font=LARGE_FONT)
    lblOne.tag_configure("ksub",offset=-2.3,font=SMALL_FONT)
    lblOne.tag_configure("kn1",font=LARGE_FONT)
    lblOne.configure(state=tk.DISABLED,borderwidth=-3)
    lblOne.grid(row=0, column=0, padx=5, pady=5)

    lblOneAns = tk.Text(parLab, width=13,height=1)
    lblOneAns.insert(tk.INSERT,str(round(K0,2)))
    lblOneAns.configure(state=tk.DISABLED)
    lblOneAns.grid(row=0, column=1, padx=5, pady=5)

    lblOneUnit = tk.Text(parLab, width=21,height=1,background='snow2')
    lblOneUnit.insert(tk.INSERT, 'cmol(+) kg-1 x 24.375')
    lblOneUnit.tag_add("kun",'1.0','1.10')
    lblOneUnit.tag_add("kusup",'1.10','1.12')
    lblOneUnit.tag_add("kun1",'1.12','1.21')
    lblOneUnit.tag_configure("kun",font=LARGE_FONT)
    lblOneUnit.tag_configure("kusup",offset=2.3,font=SMALL_FONT)
    lblOneUnit.tag_configure("kun1",font=LARGE_FONT)
    lblOneUnit.configure(state=tk.DISABLED,borderwidth=-3)
    lblOneUnit.grid(row=0, column=2, padx=5, pady=5)

    alphaPLab = tk.Text(parLab, width=4,height=1,background='snow2')
    alphaPLab.grid(row=1,column=0,pady=5,padx=5)
    alphaPLab.insert(tk.INSERT,u'\N{GREEK SMALL LETTER ALPHA}')
    alphaPLab.insert(tk.END,"k =")
    alphaPLab.tag_add("kan",'1.0','1.1')
    alphaPLab.tag_add("subscript",'1.1','1.2')
    alphaPLab.tag_add("kan1",'1.2','1.4')
    alphaPLab.tag_configure("kan",font=LARGE_FONT)
    alphaPLab.tag_configure("subscript",offset=-2.3,font=SMALL_FONT)
    alphaPLab.tag_configure("kan1",font=LARGE_FONT)
    alphaPLab.configure(state=tk.DISABLED, borderwidth=-3)

        
    alphaPText = tk.Text(parLab, width=13, height=1)
    alphaPText.grid(row=1,column=1,padx=5,pady=5)
    alphaPText.insert(tk.INSERT,'{0:.4f}'.format(alpha*10**4)+' x 10-4')
    alphaPText.tag_add('a','1.11','1.13')
    alphaPText.tag_configure('a',offset=2.3,font=SMALL_FONT)
    alphaPText.configure(state=tk.DISABLED)

    alphaPLabUnit = tk.Text(parLab, width=21,height=1,background='snow2')
    alphaPLabUnit.grid(row=1,column=2,pady=5,padx=5)
    alphaPLabUnit.insert(tk.INSERT,'day-1')
    alphaPLabUnit.tag_add("kaun",'1.0','1.3')
    alphaPLabUnit.tag_add("superscript",'1.3','1.5')
    alphaPLabUnit.tag_configure("kaun",font=LARGE_FONT)
    alphaPLabUnit.tag_configure("superscript",offset=2.3,font=SMALL_FONT)
    alphaPLabUnit.configure(state=tk.DISABLED, borderwidth=-3)


    lblThree = tk.Text(parLab, width=4,height=1,background='snow2')
    lblThree.insert(tk.INSERT,'ck =')
    lblThree.tag_add("ckn",'1.0','1.1')
    lblThree.tag_add("csub",'1.1','1.2')
    lblThree.tag_add("ckn1",'1.2','1.4')
    lblThree.tag_configure("ckn",font=LARGE_FONT)
    lblThree.tag_configure("csub",offset=-2.3,font=SMALL_FONT)
    lblThree.tag_configure("ckn1",font=LARGE_FONT)
    lblThree.configure(state=tk.DISABLED,borderwidth=-3)
    lblThree.grid(row=2, column=0, padx=5, pady=5)

    
    lblThreeAns = tk.Text(parLab, width=13,height=1)
    lblThreeAns.insert(tk.INSERT,str(round(c,4)))
    lblThreeAns.configure(state=tk.DISABLED)
    lblThreeAns.grid(row=2, column=1, padx=5, pady=5)

    lblThreeUnit = tk.Text(parLab, width=21,height=1,background='snow2')
    lblThreeUnit.insert(tk.INSERT, 'QTK (kg K ha-1)-1')
    lblThreeUnit.tag_add("cukn",'1.0','1.12')
    lblThreeUnit.tag_add("cusup1",'1.12','1.14')
    lblThreeUnit.tag_add("cukn1",'1.14','1.15')
    lblThreeUnit.tag_add("cusup2",'1.15','1.17')
    lblThreeUnit.tag_configure("cukn",font=LARGE_FONT)
    lblThreeUnit.tag_configure("cusup1",offset=2.3,font=SMALL_FONT)
    lblThreeUnit.tag_configure("cukn1",font=LARGE_FONT)
    lblThreeUnit.tag_configure("cusup2",offset=2.3,font=SMALL_FONT)
    lblThreeUnit.configure(state=tk.DISABLED,borderwidth=-3)
    lblThreeUnit.grid(row=2, column=2, padx=5, pady=5)

    
    ryKConsts = np.array([125.09, 4.24, 7.84])
    

    
    fig = Figure(figsize=(5,6), dpi=80)
    a = fig.add_subplot(211)
    a.axis([TObs[0]/365, TObs[-1]/365 + 0.5, 0, max(max(Obs1),max(Obs2),max(pk2)) + 5])
    a.xaxis.set_major_formatter(matplotlib.ticker.FormatStrFormatter('%.0f'))
    a.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=True))
    a.set_ylabel('QTK')
    b = fig.add_subplot(212)
    b.axis([TObs[0]/365, TObs[-1]/365 + 0.5, 50, 105])
    b.xaxis.set_major_formatter(matplotlib.ticker.FormatStrFormatter('%.0f'))
    b.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=True))
    b.set_ylabel('RY')
    b.set_xlabel('Years')
            
    a.plot(t/365, pk1, 'r', TObs/365, Obs1, 'r^', t/365, pk2, 'b', TObs/365, Obs2, 'b^')
    ry1 = rYieldFunc(t,pk1,ryKConsts)
    ry2 = rYieldFunc(t,pk2,ryKConsts)
    b.plot(t/365,ry1,'r',t/365,ry2,'b')
    canvas = FigureCanvasTkAgg(fig, frame)
    canvas.show()
    canvas.get_tk_widget().grid(row=0, column=0, columnspan=1, padx=10, pady=10, sticky='nsew')
    popup.mainloop()


def sh2s(TObs, Obs1, Obs2,t, pk1,pk2, K0, alpha, c):
    popup = tk.Tk()
    popup.wm_title('Sulphur parametrisation')
    frame = ttk.Frame(popup)
    frame.grid(row=0,column=0,padx=(20,0),pady=20)
    frame1=ttk.Frame(popup)
    frame1.grid(row=0,column=1, padx=(0,20), pady=20, sticky='n')
    parLab = ttk.LabelFrame(frame1,text='The resultant parameters:')
    parLab.grid(row=0, column=0, padx=20, pady=20,sticky='ew')

    lblOne = tk.Text(parLab, width=4,height=1,background='snow2')
    lblOne.insert(tk.INSERT,'S0 =')
    lblOne.tag_add("sn",'1.0','1.1')
    lblOne.tag_add("ssub",'1.1','1.2')
    lblOne.tag_add("sn1",'1.2','1.4')
    lblOne.tag_configure("sn",font=LARGE_FONT)
    lblOne.tag_configure("ssub",offset=-2.3,font=SMALL_FONT)
    lblOne.tag_configure("sn1",font=LARGE_FONT)
    lblOne.configure(state=tk.DISABLED,borderwidth=-3)
    lblOne.grid(row=0, column=0, padx=5, pady=5)

    lblOneAns = tk.Text(parLab, width=13,height=1)
    lblOneAns.insert(tk.INSERT,str(round(S0,2)))
    lblOneAns.configure(state=tk.DISABLED)
    lblOneAns.grid(row=0, column=1, padx=5, pady=5)

    lblOneUnit = tk.Text(parLab, width=21,height=1,background='snow2')
    lblOneUnit.insert(tk.INSERT, u'\N{GREEK SMALL LETTER MU}g S g-1')
    lblOneUnit.tag_add("sun",'1.0','1.6')
    lblOneUnit.tag_add("susup",'1.6','1.8')
    lblOneUnit.tag_configure("sun",font=LARGE_FONT)
    lblOneUnit.tag_configure("susup",offset=2.3,font=SMALL_FONT)
    lblOneUnit.configure(state=tk.DISABLED,borderwidth=-3)
    lblOneUnit.grid(row=0, column=2, padx=5, pady=5)

    alphaPLab = tk.Text(parLab, width=4,height=1,background='snow2')
    alphaPLab.grid(row=1,column=0,pady=5,padx=5)
    alphaPLab.insert(tk.INSERT,u'\N{GREEK SMALL LETTER ALPHA}')
    alphaPLab.insert(tk.END,"s =")
    alphaPLab.tag_add("san",'1.0','1.1')
    alphaPLab.tag_add("subscript",'1.1','1.2')
    alphaPLab.tag_add("san1",'1.2','1.4')
    alphaPLab.tag_configure("san",font=LARGE_FONT)
    alphaPLab.tag_configure("subscript",offset=-2.3,font=SMALL_FONT)
    alphaPLab.tag_configure("san1",font=LARGE_FONT)
    alphaPLab.configure(state=tk.DISABLED, borderwidth=-3)

        
    alphaPText = tk.Text(parLab, width=13, height=1)
    alphaPText.grid(row=1,column=1,padx=5,pady=5)
    alphaPText.insert(tk.INSERT,'{0:.4f}'.format(alpha*10**4)+' x 10-4')
    alphaPText.tag_add('a','1.11','1.13')
    alphaPText.tag_configure('a',offset=2.3,font=SMALL_FONT)
    alphaPText.configure(state=tk.DISABLED)

    alphaPLabUnit = tk.Text(parLab, width=21,height=1,background='snow2')
    alphaPLabUnit.grid(row=1,column=2,pady=5,padx=5)
    alphaPLabUnit.insert(tk.INSERT,'day-1')
    alphaPLabUnit.tag_add("saun",'1.0','1.3')
    alphaPLabUnit.tag_add("superscript",'1.3','1.5')
    alphaPLabUnit.tag_configure("saun",font=LARGE_FONT)
    alphaPLabUnit.tag_configure("superscript",offset=2.3,font=SMALL_FONT)
    alphaPLabUnit.configure(state=tk.DISABLED, borderwidth=-3)


    lblThree = tk.Text(parLab, width=4,height=1,background='snow2')
    lblThree.insert(tk.INSERT,'cs =')
    lblThree.tag_add("csn",'1.0','1.1')
    lblThree.tag_add("csub",'1.1','1.2')
    lblThree.tag_add("csn1",'1.2','1.4')
    lblThree.tag_configure("csn",font=LARGE_FONT)
    lblThree.tag_configure("csub",offset=-2.3,font=SMALL_FONT)
    lblThree.tag_configure("csn1",font=LARGE_FONT)
    lblThree.configure(state=tk.DISABLED,borderwidth=-3)
    lblThree.grid(row=2, column=0, padx=5, pady=5)

    
    lblThreeAns = tk.Text(parLab, width=13,height=1)
    lblThreeAns.insert(tk.INSERT,str(round(c,4)))
    lblThreeAns.configure(state=tk.DISABLED)
    lblThreeAns.grid(row=2, column=1, padx=5, pady=5)

    lblThreeUnit = tk.Text(parLab, width=21,height=1,background='snow2')
    lblThreeUnit.insert(tk.INSERT, 'EOS (kg S ha-1)-1')
    lblThreeUnit.tag_add("cusn",'1.0','1.12')
    lblThreeUnit.tag_add("cusup1",'1.12','1.14')
    lblThreeUnit.tag_add("cusn1",'1.14','1.15')
    lblThreeUnit.tag_add("cusup2",'1.15','1.17')
    lblThreeUnit.tag_configure("cusn",font=LARGE_FONT)
    lblThreeUnit.tag_configure("cusup1",offset=2.3,font=SMALL_FONT)
    lblThreeUnit.tag_configure("cusn1",font=LARGE_FONT)
    lblThreeUnit.tag_configure("cusup2",offset=2.3,font=SMALL_FONT)
    lblThreeUnit.configure(state=tk.DISABLED,borderwidth=-3)
    lblThreeUnit.grid(row=2, column=2, padx=5, pady=5)

    
    rySConsts = np.array([183.80, 0.09, 10.49])
    

    
    fig = Figure(figsize=(5,6), dpi=80)
    a = fig.add_subplot(211)
    a.axis([TObs[0]/365, TObs[-1]/365 + 0.5, 0, max(max(Obs1),max(Obs2),max(pk2)) + 5])
    a.xaxis.set_major_formatter(matplotlib.ticker.FormatStrFormatter('%.0f'))
    a.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=True))
    a.set_ylabel('EOS')
    b = fig.add_subplot(212)
    b.axis([TObs[0]/365, TObs[-1]/365 + 0.5, 50, 105])
    b.xaxis.set_major_formatter(matplotlib.ticker.FormatStrFormatter('%.0f'))
    b.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=True))
    b.set_ylabel('RY')
    b.set_xlabel('Years')
            
    a.plot(t/365, pk1, 'r', TObs/365, Obs1, 'r^', t/365, pk2, 'b', TObs/365, Obs2, 'b^')
    ry1 = rYieldFunc(t,pk1,rySConsts)
    ry2 = rYieldFunc(t,pk2,rySConsts)
    b.plot(t/365,ry1,'r',t/365,ry2,'b')
    canvas = FigureCanvasTkAgg(fig, frame)
    canvas.show()
    canvas.get_tk_widget().grid(row=0, column=0, columnspan=1, padx=10, pady=10, sticky='nsew')
    popup.mainloop()



def sh3(TObs, Obs1, Obs2, Obs3, t, pk1, pk2, pk3, P0, alpha, c):
    popup = tk.Tk()
    popup.wm_title('Phosphorous parametrization')
    frame = ttk.Frame(popup)
    frame.grid(row=0,column=0,padx=(20,0),pady=20)
    frame1=ttk.Frame(popup)
    frame1.grid(row=0,column=1, padx=(0,20), pady=20, sticky='n')
    parLab = ttk.LabelFrame(frame1,text='The resultant parameters:')
    parLab.grid(row=0, column=0, padx=20, pady=20,sticky='ew')

    lblOne = tk.Text(parLab, width=4,height=1,background='snow2')
    lblOne.insert(tk.INSERT,'P0 =')
    lblOne.tag_add('pn','1.0','1.1')
    lblOne.tag_add('pn1','1.2','1.4')
    lblOne.tag_add("psub",'1.1','1.2')
    lblOne.tag_configure("psub",offset=-2.3,font=SMALL_FONT)
    lblOne.tag_configure('pn',font=LARGE_FONT)
    lblOne.tag_configure('pn1',font=LARGE_FONT)
    lblOne.configure(state=tk.DISABLED,borderwidth=-3)
    lblOne.grid(row=0, column=0, padx=5, pady=5)

    lblOneAns = tk.Text(parLab, width=13,height=1)
    lblOneAns.insert(tk.INSERT,str(round(P0,2)))
    lblOneAns.configure(state=tk.DISABLED)
    lblOneAns.grid(row=0, column=1, padx=5, pady=5)

    lblOneUnit = tk.Text(parLab, width=20,height=1,background='snow2')
    lblOneUnit.insert(tk.INSERT, u'\N{GREEK SMALL LETTER MU}g P cm-3')
    lblOneUnit.tag_add("pun",'1.0','1.7')
    lblOneUnit.tag_add("pusub",'1.7','1.9')
    lblOneUnit.tag_configure("pun",font=LARGE_FONT)
    lblOneUnit.tag_configure("pusub",offset=2.3,font=SMALL_FONT)
    lblOneUnit.configure(state=tk.DISABLED,borderwidth=-3)
    lblOneUnit.grid(row=0, column=2, padx=5, pady=5)

    alphaPLab = tk.Text(parLab, width=4,height=1,background='snow2')
    alphaPLab.grid(row=1,column=0,pady=5,padx=5)
    alphaPLab.insert(tk.INSERT,u'\N{GREEK SMALL LETTER ALPHA}')
    alphaPLab.insert(tk.END,"p =")
    alphaPLab.tag_add("pan",'1.0','1.1')
    alphaPLab.tag_add("subscript",'1.1','1.2')
    alphaPLab.tag_add("pan1",'1.0','1.1')
    alphaPLab.tag_add("main",'1.2','1.4')
    alphaPLab.tag_configure("pan",font=LARGE_FONT)
    alphaPLab.tag_configure("subscript",offset=-2.3,font=SMALL_FONT)
    alphaPLab.tag_configure("pan1",font=LARGE_FONT)
    alphaPLab.tag_configure("main",font=LARGE_FONT)
    alphaPLab.configure(state=tk.DISABLED, borderwidth=-3)

        
    alphaPText = tk.Text(parLab, width=13, height=1)
    alphaPText.grid(row=1,column=1,padx=5,pady=5)
    alphaPText.insert(tk.INSERT,'{0:.4f}'.format(alpha*10**4)+' x 10-4')
    alphaPText.tag_add('a','1.11','1.13')
    alphaPText.tag_configure('a',offset=2.3,font=SMALL_FONT)
    alphaPText.configure(state=tk.DISABLED)

    alphaPLabUnit = tk.Text(parLab, width=20,height=1,background='snow2')
    alphaPLabUnit.grid(row=1,column=2,pady=5,padx=5)
    alphaPLabUnit.insert(tk.INSERT,'day-1')
    alphaPLabUnit.tag_add("paun",'1.0','1.3')
    alphaPLabUnit.tag_add("superscript",'1.3','1.5')
    alphaPLabUnit.tag_configure("paun",font=LARGE_FONT)
    alphaPLabUnit.tag_configure("superscript",offset=2.3,font=SMALL_FONT)
    
    alphaPLabUnit.configure(state=tk.DISABLED, borderwidth=-3)


    lblThree = tk.Text(parLab, width=4,height=1,background='snow2')
    lblThree.insert(tk.INSERT,'cp =')
    lblThree.tag_add("cpn",'1.0','1.1')
    lblThree.tag_add("csub",'1.1','1.2')
    lblThree.tag_add("cpn1",'1.2','1.4')
    lblThree.tag_configure("cpn",font=LARGE_FONT)
    lblThree.tag_configure("csub",offset=-2.3,font=SMALL_FONT)
    lblThree.tag_configure("cpn1",font=LARGE_FONT)
    lblThree.configure(state=tk.DISABLED,borderwidth=-3)
    lblThree.grid(row=2, column=0, padx=5, pady=5)

    
    lblThreeAns = tk.Text(parLab, width=13,height=1)
    lblThreeAns.insert(tk.INSERT,str(round(c,4)))
    lblThreeAns.configure(state=tk.DISABLED)
    lblThreeAns.grid(row=2, column=1, padx=5, pady=5)

    lblThreeUnit = tk.Text(parLab, width=20,height=1,background='snow2')
    lblThreeUnit.insert(tk.INSERT, 'Olsen P (kg P ha-1)-1')
    lblThreeUnit.tag_add("cupn",'1.0','1.16')
    lblThreeUnit.tag_add("cusup1",'1.16','1.18')
    lblThreeUnit.tag_add("cupn1",'1.18','1.19')
    lblThreeUnit.tag_add("cusup2",'1.19','1.21')
    lblThreeUnit.tag_configure("cupn",font=LARGE_FONT)
    lblThreeUnit.tag_configure("cusup1",offset=2.3,font=SMALL_FONT)
    lblThreeUnit.tag_configure("cupn1",font=LARGE_FONT)
    lblThreeUnit.tag_configure("cusup2",offset=2.3,font=SMALL_FONT)
    lblThreeUnit.configure(state=tk.DISABLED,borderwidth=-3)
    lblThreeUnit.grid(row=2, column=2, padx=5, pady=5)

    ryLab = ttk.LabelFrame(frame1,text='The resultant parameters:')
    ryLab.grid(row=1, column=0, padx=20, pady=20,sticky='ew')

    rygpLab = ttk.Label(ryLab, text='Soil Group')
    rygpLab.grid(row=0, column=0, padx=10,pady=10,sticky='e')

    rygpVar = tk.StringVar()
    rygpEnt = ttk.Combobox(ryLab, textvariable=rygpVar, width=10, state='readonly')
    rygpEnt['values'] = ['Sedimentary', 'Volcanic', 'Pumice', 'Recent', 'Podzols','Sands']
    rygpEnt.current(0)
    rygpEnt.grid(row=0, column=1, padx=10, pady=10)

    def plotRY():
        if rygpEnt.get() == 'Sedimentary':
            ryConsts = np.array((104.61,0,2.60),dtype=float)
        elif rygpEnt.get() == 'Volcanic':
            ryConsts = np.array((108.60,10.44,17.22),dtype=float)
        elif rygpEnt.get() == 'Pumice':
            ryConsts = np.array((106.60,15.52,23.41),dtype=float)
        elif rygpEnt.get() == 'Recent':
            ryConsts = np.array((105.00,28.49,34.75),dtype=float)
        elif rygpEnt.get() == 'Podzols':
            ryConsts = np.array((199.91,107.42,255.51),dtype=float)
        elif rygpEnt.get() == 'Sands':
            ryConsts = np.array((105.48,0.00,1.40),dtype=float)

        ry1 = rYieldFunc(t,pk1,ryConsts)
        ry2 = rYieldFunc(t,pk2,ryConsts)
        ry3 = rYieldFunc(t,pk3,ryConsts)
        b.plot(t/365,ry1,'r',t/365,ry2,'b', t/365, ry3, 'g')
        canvas = FigureCanvasTkAgg(fig, frame)
        canvas.show()
        canvas.get_tk_widget().grid(row=0, column=0, columnspan=1, padx=10, pady=10, sticky='nsew')

    ryBtn = tk.Button(ryLab, text='Plot RY', command=plotRY)
    ryBtn.grid(row=0, column=2, padx=10,pady=10)
    
    fig = Figure(figsize=(5,6), dpi=80)
    a = fig.add_subplot(211)
    a.axis([TObs[0]/365, TObs[-1]/365 + 0.5, 0, max(max(Obs1),max(Obs2), max(Obs3),max(pk3))+5])
    a.xaxis.set_major_formatter(matplotlib.ticker.FormatStrFormatter('%.0f'))
    a.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=True))
    a.set_ylabel('Olsen P')
    b = fig.add_subplot(212)
    b.axis([TObs[0]/365, TObs[-1]/365 + 0.5, 50, 105])
    b.xaxis.set_major_formatter(matplotlib.ticker.FormatStrFormatter('%.0f'))
    b.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=True))
    b.set_ylabel('RY')
    b.set_xlabel('Years')
            
    a.plot(t/365, pk1, 'r', TObs/365, Obs1, 'r^', t/365, pk2, 'b', TObs/365, Obs2, 'b^', t/365, pk3, 'g', TObs/365, Obs3, 'g^')
    canvas = FigureCanvasTkAgg(fig, frame)
    canvas.show()
    canvas.get_tk_widget().grid(row=0, column=0, columnspan=1, padx=10, pady=10, sticky='nsew')
    popup.mainloop()

def sh3k(TObs, Obs1, Obs2,Obs3,t, pk1,pk2, pk3, K0, alpha, c):
    popup = tk.Tk()
    popup.wm_title('Potassium parametrisation')
    frame = ttk.Frame(popup)
    frame.grid(row=0,column=0,padx=(20,0),pady=20)
    frame1=ttk.Frame(popup)
    frame1.grid(row=0,column=1, padx=(0,20), pady=20, sticky='n')
    parLab = ttk.LabelFrame(frame1,text='The resultant parameters:')
    parLab.grid(row=0, column=0, padx=20, pady=20,sticky='ew')

    lblOne = tk.Text(parLab, width=4,height=1,background='snow2')
    lblOne.insert(tk.INSERT,'K0 =')
    lblOne.tag_add("kn",'1.0','1.1')
    lblOne.tag_add("ksub",'1.1','1.2')
    lblOne.tag_add("kn1",'1.2','1.4')
    lblOne.tag_configure("kn",font=LARGE_FONT)
    lblOne.tag_configure("ksub",offset=-2.3,font=SMALL_FONT)
    lblOne.tag_configure("kn1",font=LARGE_FONT)
    lblOne.configure(state=tk.DISABLED,borderwidth=-3)
    lblOne.grid(row=0, column=0, padx=5, pady=5)

    lblOneAns = tk.Text(parLab, width=13,height=1)
    lblOneAns.insert(tk.INSERT,str(round(K0,2)))
    lblOneAns.configure(state=tk.DISABLED)
    lblOneAns.grid(row=0, column=1, padx=5, pady=5)

    lblOneUnit = tk.Text(parLab, width=21,height=1,background='snow2')
    lblOneUnit.insert(tk.INSERT, 'cmol(+) kg-1 x 24.375')
    lblOneUnit.tag_add("kun",'1.0','1.10')
    lblOneUnit.tag_add("kusup",'1.10','1.12')
    lblOneUnit.tag_add("kun1",'1.12','1.21')
    lblOneUnit.tag_configure("kun",font=LARGE_FONT)
    lblOneUnit.tag_configure("kusup",offset=2.3,font=SMALL_FONT)
    lblOneUnit.tag_configure("kun1",font=LARGE_FONT)
    lblOneUnit.configure(state=tk.DISABLED,borderwidth=-3)
    lblOneUnit.grid(row=0, column=2, padx=5, pady=5)

    alphaPLab = tk.Text(parLab, width=4,height=1,background='snow2')
    alphaPLab.grid(row=1,column=0,pady=5,padx=5)
    alphaPLab.insert(tk.INSERT,u'\N{GREEK SMALL LETTER ALPHA}')
    alphaPLab.insert(tk.END,"k =")
    alphaPLab.tag_add("kan",'1.0','1.1')
    alphaPLab.tag_add("subscript",'1.1','1.2')
    alphaPLab.tag_add("kan1",'1.2','1.4')
    alphaPLab.tag_configure("kan",font=LARGE_FONT)
    alphaPLab.tag_configure("subscript",offset=-2.3,font=SMALL_FONT)
    alphaPLab.tag_configure("kan1",font=LARGE_FONT)
    alphaPLab.configure(state=tk.DISABLED, borderwidth=-3)

        
    alphaPText = tk.Text(parLab, width=13, height=1)
    alphaPText.grid(row=1,column=1,padx=5,pady=5)
    alphaPText.insert(tk.INSERT,'{0:.4f}'.format(alpha*10**4)+' x 10-4')
    alphaPText.tag_add('a','1.11','1.13')
    alphaPText.tag_configure('a',offset=2.3,font=SMALL_FONT)
    alphaPText.configure(state=tk.DISABLED)

    alphaPLabUnit = tk.Text(parLab, width=21,height=1,background='snow2')
    alphaPLabUnit.grid(row=1,column=2,pady=5,padx=5)
    alphaPLabUnit.insert(tk.INSERT,'day-1')
    alphaPLabUnit.tag_add("kaun",'1.0','1.3')
    alphaPLabUnit.tag_add("superscript",'1.3','1.5')
    alphaPLabUnit.tag_configure("kaun",font=LARGE_FONT)
    alphaPLabUnit.tag_configure("superscript",offset=2.3,font=SMALL_FONT)
    alphaPLabUnit.configure(state=tk.DISABLED, borderwidth=-3)


    lblThree = tk.Text(parLab, width=4,height=1,background='snow2')
    lblThree.insert(tk.INSERT,'ck =')
    lblThree.tag_add("ckn",'1.0','1.1')
    lblThree.tag_add("csub",'1.1','1.2')
    lblThree.tag_add("ckn1",'1.2','1.4')
    lblThree.tag_configure("ckn",font=LARGE_FONT)
    lblThree.tag_configure("csub",offset=-2.3,font=SMALL_FONT)
    lblThree.tag_configure("ckn1",font=LARGE_FONT)
    lblThree.configure(state=tk.DISABLED,borderwidth=-3)
    lblThree.grid(row=2, column=0, padx=5, pady=5)

    
    lblThreeAns = tk.Text(parLab, width=13,height=1)
    lblThreeAns.insert(tk.INSERT,str(round(c,4)))
    lblThreeAns.configure(state=tk.DISABLED)
    lblThreeAns.grid(row=2, column=1, padx=5, pady=5)

    lblThreeUnit = tk.Text(parLab, width=21,height=1,background='snow2')
    lblThreeUnit.insert(tk.INSERT, 'QTK (kg K ha-1)-1')
    lblThreeUnit.tag_add("cukn",'1.0','1.12')
    lblThreeUnit.tag_add("cusup1",'1.12','1.14')
    lblThreeUnit.tag_add("cukn1",'1.14','1.15')
    lblThreeUnit.tag_add("cusup2",'1.15','1.17')
    lblThreeUnit.tag_configure("cukn",font=LARGE_FONT)
    lblThreeUnit.tag_configure("cusup1",offset=2.3,font=SMALL_FONT)
    lblThreeUnit.tag_configure("cukn1",font=LARGE_FONT)
    lblThreeUnit.tag_configure("cusup2",offset=2.3,font=SMALL_FONT)
    lblThreeUnit.configure(state=tk.DISABLED,borderwidth=-3)
    lblThreeUnit.grid(row=2, column=2, padx=5, pady=5)

    
    ryKConsts = np.array([125.09, 4.24, 7.84])
    

    
    fig = Figure(figsize=(5,6), dpi=80)
    a = fig.add_subplot(211)
    a.axis([TObs[0]/365, TObs[-1]/365 + 0.5, 0, max(max(Obs1),max(Obs2),max(Obs3),max(pk3)) + 5])
    a.xaxis.set_major_formatter(matplotlib.ticker.FormatStrFormatter('%.0f'))
    a.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=True))
    a.set_ylabel('QTK')
    b = fig.add_subplot(212)
    b.axis([TObs[0]/365, TObs[-1]/365 + 0.5, 50, 105])
    b.xaxis.set_major_formatter(matplotlib.ticker.FormatStrFormatter('%.0f'))
    b.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=True))
    b.set_ylabel('RY')
    b.set_xlabel('Years')
            
    a.plot(t/365, pk1, 'r', TObs/365, Obs1, 'r^', t/365, pk2, 'b', TObs/365, Obs2, 'b^', t/365, pk3, 'g', TObs/365, Obs3, 'g^')
    ry1 = rYieldFunc(t,pk1,ryKConsts)
    ry2 = rYieldFunc(t,pk2,ryKConsts)
    ry3 = rYieldFunc(t,pk3,ryKConsts)
    b.plot(t/365,ry1,'r',t/365,ry2,'b', t/365, ry3, 'g')
    canvas = FigureCanvasTkAgg(fig, frame)
    canvas.show()
    canvas.get_tk_widget().grid(row=0, column=0, columnspan=1, padx=10, pady=10, sticky='nsew')
    popup.mainloop()

def sh3s(TObs, Obs1, Obs2,Obs3,t, pk1,pk2, pk3, K0, alpha, c):
    popup = tk.Tk()
    popup.wm_title('Sulphur parametrisation')
    frame = ttk.Frame(popup)
    frame.grid(row=0,column=0,padx=(20,0),pady=20)
    frame1=ttk.Frame(popup)
    frame1.grid(row=0,column=1, padx=(0,20), pady=20, sticky='n')
    parLab = ttk.LabelFrame(frame1,text='The resultant parameters:')
    parLab.grid(row=0, column=0, padx=20, pady=20,sticky='ew')

    lblOne = tk.Text(parLab, width=4,height=1,background='snow2')
    lblOne.insert(tk.INSERT,'S0 =')
    lblOne.tag_add("sn",'1.0','1.1')
    lblOne.tag_add("ssub",'1.1','1.2')
    lblOne.tag_add("sn1",'1.2','1.4')
    lblOne.tag_configure("sn",font=LARGE_FONT)
    lblOne.tag_configure("ssub",offset=-2.3,font=SMALL_FONT)
    lblOne.tag_configure("sn1",font=LARGE_FONT)
    lblOne.configure(state=tk.DISABLED,borderwidth=-3)
    lblOne.grid(row=0, column=0, padx=5, pady=5)

    lblOneAns = tk.Text(parLab, width=13,height=1)
    lblOneAns.insert(tk.INSERT,str(round(S0,2)))
    lblOneAns.configure(state=tk.DISABLED)
    lblOneAns.grid(row=0, column=1, padx=5, pady=5)

    lblOneUnit = tk.Text(parLab, width=21,height=1,background='snow2')
    lblOneUnit.insert(tk.INSERT, u'\N{GREEK SMALL LETTER MU}g S g-1')
    lblOneUnit.tag_add("sun",'1.0','1.6')
    lblOneUnit.tag_add("susup",'1.6','1.8')
    lblOneUnit.tag_configure("sun",font=LARGE_FONT)
    lblOneUnit.tag_configure("susup",offset=2.3,font=SMALL_FONT)
    lblOneUnit.configure(state=tk.DISABLED,borderwidth=-3)
    lblOneUnit.grid(row=0, column=2, padx=5, pady=5)

    alphaPLab = tk.Text(parLab, width=4,height=1,background='snow2')
    alphaPLab.grid(row=1,column=0,pady=5,padx=5)
    alphaPLab.insert(tk.INSERT,u'\N{GREEK SMALL LETTER ALPHA}')
    alphaPLab.insert(tk.END,"s =")
    alphaPLab.tag_add("san",'1.0','1.1')
    alphaPLab.tag_add("subscript",'1.1','1.2')
    alphaPLab.tag_add("san1",'1.2','1.4')
    alphaPLab.tag_configure("san",font=LARGE_FONT)
    alphaPLab.tag_configure("subscript",offset=-2.3,font=SMALL_FONT)
    alphaPLab.tag_configure("san1",font=LARGE_FONT)
    alphaPLab.configure(state=tk.DISABLED, borderwidth=-3)

        
    alphaPText = tk.Text(parLab, width=13, height=1)
    alphaPText.grid(row=1,column=1,padx=5,pady=5)
    alphaPText.insert(tk.INSERT,'{0:.4f}'.format(alpha*10**4)+' x 10-4')
    alphaPText.tag_add('a','1.11','1.13')
    alphaPText.tag_configure('a',offset=2.3,font=SMALL_FONT)
    alphaPText.configure(state=tk.DISABLED)

    alphaPLabUnit = tk.Text(parLab, width=21,height=1,background='snow2')
    alphaPLabUnit.grid(row=1,column=2,pady=5,padx=5)
    alphaPLabUnit.insert(tk.INSERT,'day-1')
    alphaPLabUnit.tag_add("saun",'1.0','1.3')
    alphaPLabUnit.tag_add("superscript",'1.3','1.5')
    alphaPLabUnit.tag_configure("saun",font=LARGE_FONT)
    alphaPLabUnit.tag_configure("superscript",offset=2.3,font=SMALL_FONT)
    alphaPLabUnit.configure(state=tk.DISABLED, borderwidth=-3)


    lblThree = tk.Text(parLab, width=4,height=1,background='snow2')
    lblThree.insert(tk.INSERT,'cs =')
    lblThree.tag_add("csn",'1.0','1.1')
    lblThree.tag_add("csub",'1.1','1.2')
    lblThree.tag_add("csn1",'1.2','1.4')
    lblThree.tag_configure("csn",font=LARGE_FONT)
    lblThree.tag_configure("csub",offset=-2.3,font=SMALL_FONT)
    lblThree.tag_configure("csn1",font=LARGE_FONT)
    lblThree.configure(state=tk.DISABLED,borderwidth=-3)
    lblThree.grid(row=2, column=0, padx=5, pady=5)

    
    lblThreeAns = tk.Text(parLab, width=13,height=1)
    lblThreeAns.insert(tk.INSERT,str(round(c,4)))
    lblThreeAns.configure(state=tk.DISABLED)
    lblThreeAns.grid(row=2, column=1, padx=5, pady=5)

    lblThreeUnit = tk.Text(parLab, width=21,height=1,background='snow2')
    lblThreeUnit.insert(tk.INSERT, 'EOS (kg S ha-1)-1')
    lblThreeUnit.tag_add("cusn",'1.0','1.12')
    lblThreeUnit.tag_add("cusup1",'1.12','1.14')
    lblThreeUnit.tag_add("cusn1",'1.14','1.15')
    lblThreeUnit.tag_add("cusup2",'1.15','1.17')
    lblThreeUnit.tag_configure("cusn",font=LARGE_FONT)
    lblThreeUnit.tag_configure("cusup1",offset=2.3,font=SMALL_FONT)
    lblThreeUnit.tag_configure("cusn1",font=LARGE_FONT)
    lblThreeUnit.tag_configure("cusup2",offset=2.3,font=SMALL_FONT)
    lblThreeUnit.configure(state=tk.DISABLED,borderwidth=-3)
    lblThreeUnit.grid(row=2, column=2, padx=5, pady=5)

    
    rySConsts = np.array([183.80, 0.09, 10.49])
    

    
    fig = Figure(figsize=(5,6), dpi=80)
    a = fig.add_subplot(211)
    a.axis([TObs[0]/365, TObs[-1]/365 + 0.5, 0, max(max(Obs1),max(Obs2),max(Obs3),max(pk3)) + 5])
    a.xaxis.set_major_formatter(matplotlib.ticker.FormatStrFormatter('%.0f'))
    a.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=True))
    a.set_ylabel('EOS')
    b = fig.add_subplot(212)
    b.axis([TObs[0]/365, TObs[-1]/365 + 0.5, 50, 105])
    b.xaxis.set_major_formatter(matplotlib.ticker.FormatStrFormatter('%.0f'))
    b.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=True))
    b.set_ylabel('RY')
    b.set_xlabel('Years')
            
    a.plot(t/365, pk1, 'r', TObs/365, Obs1, 'r^', t/365, pk2, 'b', TObs/365, Obs2, 'b^', t/365, pk3, 'g', TObs/365, Obs3, 'g^')
    ry1 = rYieldFunc(t,pk1,rySConsts)
    ry2 = rYieldFunc(t,pk2,rySConsts)
    ry3 = rYieldFunc(t,pk3,rySConsts)
    b.plot(t/365,ry1,'r',t/365,ry2,'b', t/365, ry3, 'g')
    canvas = FigureCanvasTkAgg(fig, frame)
    canvas.show()
    canvas.get_tk_widget().grid(row=0, column=0, columnspan=1, padx=10, pady=10, sticky='nsew')
    popup.mainloop()


def sh4(TObs, Obs1, Obs2, Obs3, Obs4, t, pk1, pk2, pk3, pk4, P0, alpha, c):
    popup = tk.Tk()
    popup.wm_title('Phosphorous parametrization')
    frame = ttk.Frame(popup)
    frame.grid(row=0,column=0,padx=(20,0),pady=20)
    frame1=ttk.Frame(popup)
    frame1.grid(row=0,column=1, padx=(0,20), pady=20, sticky='n')
    parLab = ttk.LabelFrame(frame1,text='The resultant parameters:')
    parLab.grid(row=0, column=0, padx=20, pady=20,sticky='ew')

    lblOne = tk.Text(parLab, width=4,height=1,background='snow2')
    lblOne.insert(tk.INSERT,'P0 =')
    lblOne.tag_add('pn','1.0','1.1')
    lblOne.tag_add('pn1','1.2','1.4')
    lblOne.tag_add("psub",'1.1','1.2')
    lblOne.tag_configure("psub",offset=-2.3,font=SMALL_FONT)
    lblOne.tag_configure('pn',font=LARGE_FONT)
    lblOne.tag_configure('pn1',font=LARGE_FONT)
    lblOne.configure(state=tk.DISABLED,borderwidth=-3)
    lblOne.grid(row=0, column=0, padx=5, pady=5)

    lblOneAns = tk.Text(parLab, width=13,height=1)
    lblOneAns.insert(tk.INSERT,str(round(P0,2)))
    lblOneAns.configure(state=tk.DISABLED)
    lblOneAns.grid(row=0, column=1, padx=5, pady=5)

    lblOneUnit = tk.Text(parLab, width=20,height=1,background='snow2')
    lblOneUnit.insert(tk.INSERT, u'\N{GREEK SMALL LETTER MU}g P cm-3')
    lblOneUnit.tag_add("pun",'1.0','1.7')
    lblOneUnit.tag_add("pusub",'1.7','1.9')
    lblOneUnit.tag_configure("pun",font=LARGE_FONT)
    lblOneUnit.tag_configure("pusub",offset=2.3,font=SMALL_FONT)
    lblOneUnit.configure(state=tk.DISABLED,borderwidth=-3)
    lblOneUnit.grid(row=0, column=2, padx=5, pady=5)

    alphaPLab = tk.Text(parLab, width=4,height=1,background='snow2')
    alphaPLab.grid(row=1,column=0,pady=5,padx=5)
    alphaPLab.insert(tk.INSERT,u'\N{GREEK SMALL LETTER ALPHA}')
    alphaPLab.insert(tk.END,"p =")
    alphaPLab.tag_add("pan",'1.0','1.1')
    alphaPLab.tag_add("subscript",'1.1','1.2')
    alphaPLab.tag_add("pan1",'1.0','1.1')
    alphaPLab.tag_add("main",'1.2','1.4')
    alphaPLab.tag_configure("pan",font=LARGE_FONT)
    alphaPLab.tag_configure("subscript",offset=-2.3,font=SMALL_FONT)
    alphaPLab.tag_configure("pan1",font=LARGE_FONT)
    alphaPLab.tag_configure("main",font=LARGE_FONT)
    alphaPLab.configure(state=tk.DISABLED, borderwidth=-3)

        
    alphaPText = tk.Text(parLab, width=13, height=1)
    alphaPText.grid(row=1,column=1,padx=5,pady=5)
    alphaPText.insert(tk.INSERT,'{0:.4f}'.format(alpha*10**4)+' x 10-4')
    alphaPText.tag_add('a','1.11','1.13')
    alphaPText.tag_configure('a',offset=2.3,font=SMALL_FONT)
    alphaPText.configure(state=tk.DISABLED)

    alphaPLabUnit = tk.Text(parLab, width=20,height=1,background='snow2')
    alphaPLabUnit.grid(row=1,column=2,pady=5,padx=5)
    alphaPLabUnit.insert(tk.INSERT,'day-1')
    alphaPLabUnit.tag_add("paun",'1.0','1.3')
    alphaPLabUnit.tag_add("superscript",'1.3','1.5')
    alphaPLabUnit.tag_configure("paun",font=LARGE_FONT)
    alphaPLabUnit.tag_configure("superscript",offset=2.3,font=SMALL_FONT)
    
    alphaPLabUnit.configure(state=tk.DISABLED, borderwidth=-3)


    lblThree = tk.Text(parLab, width=4,height=1,background='snow2')
    lblThree.insert(tk.INSERT,'cp =')
    lblThree.tag_add("cpn",'1.0','1.1')
    lblThree.tag_add("csub",'1.1','1.2')
    lblThree.tag_add("cpn1",'1.2','1.4')
    lblThree.tag_configure("cpn",font=LARGE_FONT)
    lblThree.tag_configure("csub",offset=-2.3,font=SMALL_FONT)
    lblThree.tag_configure("cpn1",font=LARGE_FONT)
    lblThree.configure(state=tk.DISABLED,borderwidth=-3)
    lblThree.grid(row=2, column=0, padx=5, pady=5)

    
    lblThreeAns = tk.Text(parLab, width=13,height=1)
    lblThreeAns.insert(tk.INSERT,str(round(c,4)))
    lblThreeAns.configure(state=tk.DISABLED)
    lblThreeAns.grid(row=2, column=1, padx=5, pady=5)

    lblThreeUnit = tk.Text(parLab, width=20,height=1,background='snow2')
    lblThreeUnit.insert(tk.INSERT, 'Olsen P (kg P ha-1)-1')
    lblThreeUnit.tag_add("cupn",'1.0','1.16')
    lblThreeUnit.tag_add("cusup1",'1.16','1.18')
    lblThreeUnit.tag_add("cupn1",'1.18','1.19')
    lblThreeUnit.tag_add("cusup2",'1.19','1.21')
    lblThreeUnit.tag_configure("cupn",font=LARGE_FONT)
    lblThreeUnit.tag_configure("cusup1",offset=2.3,font=SMALL_FONT)
    lblThreeUnit.tag_configure("cupn1",font=LARGE_FONT)
    lblThreeUnit.tag_configure("cusup2",offset=2.3,font=SMALL_FONT)
    lblThreeUnit.configure(state=tk.DISABLED,borderwidth=-3)
    lblThreeUnit.grid(row=2, column=2, padx=5, pady=5)

    ryLab = ttk.LabelFrame(frame1,text='The resultant parameters:')
    ryLab.grid(row=1, column=0, padx=20, pady=20,sticky='ew')

    rygpLab = ttk.Label(ryLab, text='Soil Group')
    rygpLab.grid(row=0, column=0, padx=10,pady=10,sticky='e')

    rygpVar = tk.StringVar()
    rygpEnt = ttk.Combobox(ryLab, textvariable=rygpVar, width=10, state='readonly')
    rygpEnt['values'] = ['Sedimentary', 'Volcanic', 'Pumice', 'Recent', 'Podzols','Sands']
    rygpEnt.current(0)
    rygpEnt.grid(row=0, column=1, padx=10, pady=10)

    def plotRY():
        if rygpEnt.get() == 'Sedimentary':
            ryConsts = np.array((104.61,0,2.60),dtype=float)
        elif rygpEnt.get() == 'Volcanic':
            ryConsts = np.array((108.60,10.44,17.22),dtype=float)
        elif rygpEnt.get() == 'Pumice':
            ryConsts = np.array((106.60,15.52,23.41),dtype=float)
        elif rygpEnt.get() == 'Recent':
            ryConsts = np.array((105.00,28.49,34.75),dtype=float)
        elif rygpEnt.get() == 'Podzols':
            ryConsts = np.array((199.91,107.42,255.51),dtype=float)
        elif rygpEnt.get() == 'Sands':
            ryConsts = np.array((105.48,0.00,1.40),dtype=float)

        ry1 = rYieldFunc(t,pk1,ryConsts)
        ry2 = rYieldFunc(t,pk2,ryConsts)
        ry3 = rYieldFunc(t,pk3,ryConsts)
        ry4 = rYieldFunc(t,pk4,ryConsts)
        b.plot(t/365,ry1,'r',t/365,ry2,'b', t/365, ry3, 'g', t/365, ry4, 'y')
        canvas = FigureCanvasTkAgg(fig, frame)
        canvas.show()
        canvas.get_tk_widget().grid(row=0, column=0, columnspan=1, padx=10, pady=10, sticky='nsew')

    ryBtn = tk.Button(ryLab, text='Plot RY', command=plotRY)
    ryBtn.grid(row=0, column=2, padx=10,pady=10)
    
    fig = Figure(figsize=(5,6), dpi=80)
    a = fig.add_subplot(211)
    a.axis([TObs[0]/365-0.5, TObs[-1]/365 + 0.5, 0, max(max(Obs1),max(Obs2), max(Obs3),max(Obs4),max(pk4))+5])
    a.xaxis.set_major_formatter(matplotlib.ticker.FormatStrFormatter('%.0f'))
    a.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=True))
    a.set_ylabel('Olsen P')
    b = fig.add_subplot(212)
    b.axis([TObs[0]/365-0.5, TObs[-1]/365 + 0.5, 50, 105])
    b.xaxis.set_major_formatter(matplotlib.ticker.FormatStrFormatter('%.0f'))
    b.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=True))
    b.set_ylabel('RY')
    b.set_xlabel('Years')
            
    a.plot(t/365, pk1, 'r', TObs/365, Obs1, 'r^', t/365, pk2, 'b', TObs/365, Obs2, 'b^', t/365, pk3, 'g', TObs/365, Obs3, 'g^', t/365, pk4, 'y', TObs/365, Obs4, 'y^')
    canvas = FigureCanvasTkAgg(fig, frame)
    canvas.show()
    canvas.get_tk_widget().grid(row=0, column=0, columnspan=1, padx=10, pady=10, sticky='nsew')
    popup.mainloop()

def sh4k(TObs, Obs1, Obs2,Obs3, Obs4, t, pk1,pk2, pk3, pk4, K0, alpha, c):
    popup = tk.Tk()
    popup.wm_title('Potassium parametrisation')
    frame = ttk.Frame(popup)
    frame.grid(row=0,column=0,padx=(20,0),pady=20)
    frame1=ttk.Frame(popup)
    frame1.grid(row=0,column=1, padx=(0,20), pady=20, sticky='n')
    parLab = ttk.LabelFrame(frame1,text='The resultant parameters:')
    parLab.grid(row=0, column=0, padx=20, pady=20,sticky='ew')

    lblOne = tk.Text(parLab, width=4,height=1,background='snow2')
    lblOne.insert(tk.INSERT,'K0 =')
    lblOne.tag_add("kn",'1.0','1.1')
    lblOne.tag_add("ksub",'1.1','1.2')
    lblOne.tag_add("kn1",'1.2','1.4')
    lblOne.tag_configure("kn",font=LARGE_FONT)
    lblOne.tag_configure("ksub",offset=-2.3,font=SMALL_FONT)
    lblOne.tag_configure("kn1",font=LARGE_FONT)
    lblOne.configure(state=tk.DISABLED,borderwidth=-3)
    lblOne.grid(row=0, column=0, padx=5, pady=5)

    lblOneAns = tk.Text(parLab, width=13,height=1)
    lblOneAns.insert(tk.INSERT,str(round(K0,2)))
    lblOneAns.configure(state=tk.DISABLED)
    lblOneAns.grid(row=0, column=1, padx=5, pady=5)

    lblOneUnit = tk.Text(parLab, width=21,height=1,background='snow2')
    lblOneUnit.insert(tk.INSERT, 'cmol(+) kg-1 x 24.375')
    lblOneUnit.tag_add("kun",'1.0','1.10')
    lblOneUnit.tag_add("kusup",'1.10','1.12')
    lblOneUnit.tag_add("kun1",'1.12','1.21')
    lblOneUnit.tag_configure("kun",font=LARGE_FONT)
    lblOneUnit.tag_configure("kusup",offset=2.3,font=SMALL_FONT)
    lblOneUnit.tag_configure("kun1",font=LARGE_FONT)
    lblOneUnit.configure(state=tk.DISABLED,borderwidth=-3)
    lblOneUnit.grid(row=0, column=2, padx=5, pady=5)

    alphaPLab = tk.Text(parLab, width=4,height=1,background='snow2')
    alphaPLab.grid(row=1,column=0,pady=5,padx=5)
    alphaPLab.insert(tk.INSERT,u'\N{GREEK SMALL LETTER ALPHA}')
    alphaPLab.insert(tk.END,"k =")
    alphaPLab.tag_add("kan",'1.0','1.1')
    alphaPLab.tag_add("subscript",'1.1','1.2')
    alphaPLab.tag_add("kan1",'1.2','1.4')
    alphaPLab.tag_configure("kan",font=LARGE_FONT)
    alphaPLab.tag_configure("subscript",offset=-2.3,font=SMALL_FONT)
    alphaPLab.tag_configure("kan1",font=LARGE_FONT)
    alphaPLab.configure(state=tk.DISABLED, borderwidth=-3)

        
    alphaPText = tk.Text(parLab, width=13, height=1)
    alphaPText.grid(row=1,column=1,padx=5,pady=5)
    alphaPText.insert(tk.INSERT,'{0:.4f}'.format(alpha*10**4)+' x 10-4')
    alphaPText.tag_add('a','1.11','1.13')
    alphaPText.tag_configure('a',offset=2.3,font=SMALL_FONT)
    alphaPText.configure(state=tk.DISABLED)

    alphaPLabUnit = tk.Text(parLab, width=21,height=1,background='snow2')
    alphaPLabUnit.grid(row=1,column=2,pady=5,padx=5)
    alphaPLabUnit.insert(tk.INSERT,'day-1')
    alphaPLabUnit.tag_add("kaun",'1.0','1.3')
    alphaPLabUnit.tag_add("superscript",'1.3','1.5')
    alphaPLabUnit.tag_configure("kaun",font=LARGE_FONT)
    alphaPLabUnit.tag_configure("superscript",offset=2.3,font=SMALL_FONT)
    alphaPLabUnit.configure(state=tk.DISABLED, borderwidth=-3)


    lblThree = tk.Text(parLab, width=4,height=1,background='snow2')
    lblThree.insert(tk.INSERT,'ck =')
    lblThree.tag_add("ckn",'1.0','1.1')
    lblThree.tag_add("csub",'1.1','1.2')
    lblThree.tag_add("ckn1",'1.2','1.4')
    lblThree.tag_configure("ckn",font=LARGE_FONT)
    lblThree.tag_configure("csub",offset=-2.3,font=SMALL_FONT)
    lblThree.tag_configure("ckn1",font=LARGE_FONT)
    lblThree.configure(state=tk.DISABLED,borderwidth=-3)
    lblThree.grid(row=2, column=0, padx=5, pady=5)

    
    lblThreeAns = tk.Text(parLab, width=13,height=1)
    lblThreeAns.insert(tk.INSERT,str(round(c,4)))
    lblThreeAns.configure(state=tk.DISABLED)
    lblThreeAns.grid(row=2, column=1, padx=5, pady=5)

    lblThreeUnit = tk.Text(parLab, width=21,height=1,background='snow2')
    lblThreeUnit.insert(tk.INSERT, 'QTK (kg K ha-1)-1')
    lblThreeUnit.tag_add("cukn",'1.0','1.12')
    lblThreeUnit.tag_add("cusup1",'1.12','1.14')
    lblThreeUnit.tag_add("cukn1",'1.14','1.15')
    lblThreeUnit.tag_add("cusup2",'1.15','1.17')
    lblThreeUnit.tag_configure("cukn",font=LARGE_FONT)
    lblThreeUnit.tag_configure("cusup1",offset=2.3,font=SMALL_FONT)
    lblThreeUnit.tag_configure("cukn1",font=LARGE_FONT)
    lblThreeUnit.tag_configure("cusup2",offset=2.3,font=SMALL_FONT)
    lblThreeUnit.configure(state=tk.DISABLED,borderwidth=-3)
    lblThreeUnit.grid(row=2, column=2, padx=5, pady=5)

    
    ryKConsts = np.array([125.09, 4.24, 7.84])
    

    
    fig = Figure(figsize=(5,6), dpi=80)
    a = fig.add_subplot(211)
    a.axis([TObs[0]/365, TObs[-1]/365 + 0.5, 0, max(max(Obs1),max(Obs2),max(Obs3),max(Obs4),max(pk4)) + 5])
    a.xaxis.set_major_formatter(matplotlib.ticker.FormatStrFormatter('%.0f'))
    a.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=True))
    a.set_ylabel('QTK')
    b = fig.add_subplot(212)
    b.axis([TObs[0]/365, TObs[-1]/365 + 0.5, 50, 105])
    b.xaxis.set_major_formatter(matplotlib.ticker.FormatStrFormatter('%.0f'))
    b.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=True))
    b.set_ylabel('RY')
    b.set_xlabel('Years')
            
    a.plot(t/365, pk1, 'r', TObs/365, Obs1, 'r^', t/365, pk2, 'b', TObs/365, Obs2, 'b^', t/365, pk3, 'g', TObs/365, Obs3, 'g^', t/365, pk4, 'y', TObs/365, Obs4, 'y^')
    ry1 = rYieldFunc(t,pk1,ryKConsts)
    ry2 = rYieldFunc(t,pk2,ryKConsts)
    ry3 = rYieldFunc(t,pk3,ryKConsts)
    ry4 = rYieldFunc(t,pk4,ryKConsts)
    b.plot(t/365,ry1,'r',t/365,ry2,'b', t/365, ry3, 'g', t/365, ry4, 'y')
    canvas = FigureCanvasTkAgg(fig, frame)
    canvas.show()
    canvas.get_tk_widget().grid(row=0, column=0, columnspan=1, padx=10, pady=10, sticky='nsew')
    popup.mainloop()

def sh4s(TObs, Obs1, Obs2,Obs3, Obs4, t, pk1,pk2, pk3, pk4, K0, alpha, c):
    popup = tk.Tk()
    popup.wm_title('Sulphur parametrisation')
    frame = ttk.Frame(popup)
    frame.grid(row=0,column=0,padx=(20,0),pady=20)
    frame1=ttk.Frame(popup)
    frame1.grid(row=0,column=1, padx=(0,20), pady=20, sticky='n')
    parLab = ttk.LabelFrame(frame1,text='The resultant parameters:')
    parLab.grid(row=0, column=0, padx=20, pady=20,sticky='ew')

    lblOne = tk.Text(parLab, width=4,height=1,background='snow2')
    lblOne.insert(tk.INSERT,'S0 =')
    lblOne.tag_add("sn",'1.0','1.1')
    lblOne.tag_add("ssub",'1.1','1.2')
    lblOne.tag_add("sn1",'1.2','1.4')
    lblOne.tag_configure("sn",font=LARGE_FONT)
    lblOne.tag_configure("ssub",offset=-2.3,font=SMALL_FONT)
    lblOne.tag_configure("sn1",font=LARGE_FONT)
    lblOne.configure(state=tk.DISABLED,borderwidth=-3)
    lblOne.grid(row=0, column=0, padx=5, pady=5)

    lblOneAns = tk.Text(parLab, width=13,height=1)
    lblOneAns.insert(tk.INSERT,str(round(S0,2)))
    lblOneAns.configure(state=tk.DISABLED)
    lblOneAns.grid(row=0, column=1, padx=5, pady=5)

    lblOneUnit = tk.Text(parLab, width=21,height=1,background='snow2')
    lblOneUnit.insert(tk.INSERT, u'\N{GREEK SMALL LETTER MU}g S g-1')
    lblOneUnit.tag_add("sun",'1.0','1.6')
    lblOneUnit.tag_add("susup",'1.6','1.8')
    lblOneUnit.tag_configure("sun",font=LARGE_FONT)
    lblOneUnit.tag_configure("susup",offset=2.3,font=SMALL_FONT)
    lblOneUnit.configure(state=tk.DISABLED,borderwidth=-3)
    lblOneUnit.grid(row=0, column=2, padx=5, pady=5)

    alphaPLab = tk.Text(parLab, width=4,height=1,background='snow2')
    alphaPLab.grid(row=1,column=0,pady=5,padx=5)
    alphaPLab.insert(tk.INSERT,u'\N{GREEK SMALL LETTER ALPHA}')
    alphaPLab.insert(tk.END,"s =")
    alphaPLab.tag_add("san",'1.0','1.1')
    alphaPLab.tag_add("subscript",'1.1','1.2')
    alphaPLab.tag_add("san1",'1.2','1.4')
    alphaPLab.tag_configure("san",font=LARGE_FONT)
    alphaPLab.tag_configure("subscript",offset=-2.3,font=SMALL_FONT)
    alphaPLab.tag_configure("san1",font=LARGE_FONT)
    alphaPLab.configure(state=tk.DISABLED, borderwidth=-3)

        
    alphaPText = tk.Text(parLab, width=13, height=1)
    alphaPText.grid(row=1,column=1,padx=5,pady=5)
    alphaPText.insert(tk.INSERT,'{0:.4f}'.format(alpha*10**4)+' x 10-4')
    alphaPText.tag_add('a','1.11','1.13')
    alphaPText.tag_configure('a',offset=2.3,font=SMALL_FONT)
    alphaPText.configure(state=tk.DISABLED)

    alphaPLabUnit = tk.Text(parLab, width=21,height=1,background='snow2')
    alphaPLabUnit.grid(row=1,column=2,pady=5,padx=5)
    alphaPLabUnit.insert(tk.INSERT,'day-1')
    alphaPLabUnit.tag_add("saun",'1.0','1.3')
    alphaPLabUnit.tag_add("superscript",'1.3','1.5')
    alphaPLabUnit.tag_configure("saun",font=LARGE_FONT)
    alphaPLabUnit.tag_configure("superscript",offset=2.3,font=SMALL_FONT)
    alphaPLabUnit.configure(state=tk.DISABLED, borderwidth=-3)


    lblThree = tk.Text(parLab, width=4,height=1,background='snow2')
    lblThree.insert(tk.INSERT,'cs =')
    lblThree.tag_add("csn",'1.0','1.1')
    lblThree.tag_add("csub",'1.1','1.2')
    lblThree.tag_add("csn1",'1.2','1.4')
    lblThree.tag_configure("csn",font=LARGE_FONT)
    lblThree.tag_configure("csub",offset=-2.3,font=SMALL_FONT)
    lblThree.tag_configure("csn1",font=LARGE_FONT)
    lblThree.configure(state=tk.DISABLED,borderwidth=-3)
    lblThree.grid(row=2, column=0, padx=5, pady=5)

    
    lblThreeAns = tk.Text(parLab, width=13,height=1)
    lblThreeAns.insert(tk.INSERT,str(round(c,4)))
    lblThreeAns.configure(state=tk.DISABLED)
    lblThreeAns.grid(row=2, column=1, padx=5, pady=5)

    lblThreeUnit = tk.Text(parLab, width=21,height=1,background='snow2')
    lblThreeUnit.insert(tk.INSERT, 'EOS (kg S ha-1)-1')
    lblThreeUnit.tag_add("cusn",'1.0','1.12')
    lblThreeUnit.tag_add("cusup1",'1.12','1.14')
    lblThreeUnit.tag_add("cusn1",'1.14','1.15')
    lblThreeUnit.tag_add("cusup2",'1.15','1.17')
    lblThreeUnit.tag_configure("cusn",font=LARGE_FONT)
    lblThreeUnit.tag_configure("cusup1",offset=2.3,font=SMALL_FONT)
    lblThreeUnit.tag_configure("cusn1",font=LARGE_FONT)
    lblThreeUnit.tag_configure("cusup2",offset=2.3,font=SMALL_FONT)
    lblThreeUnit.configure(state=tk.DISABLED,borderwidth=-3)
    lblThreeUnit.grid(row=2, column=2, padx=5, pady=5)

    
    rySConsts = np.array([183.80, 0.09, 10.49])
    

    
    fig = Figure(figsize=(5,6), dpi=80)
    a = fig.add_subplot(211)
    a.axis([TObs[0]/365, TObs[-1]/365 + 0.5, 0, max(max(Obs1),max(Obs2),max(Obs3),max(Obs4),max(pk4)) + 5])
    a.xaxis.set_major_formatter(matplotlib.ticker.FormatStrFormatter('%.0f'))
    a.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=True))
    a.set_ylabel('EOS')
    b = fig.add_subplot(212)
    b.axis([TObs[0]/365, TObs[-1]/365 + 0.5, 50, 105])
    b.xaxis.set_major_formatter(matplotlib.ticker.FormatStrFormatter('%.0f'))
    b.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=True))
    b.set_ylabel('RY')
    b.set_xlabel('Years')
            
    a.plot(t/365, pk1, 'r', TObs/365, Obs1, 'r^', t/365, pk2, 'b', TObs/365, Obs2, 'b^', t/365, pk3, 'g', TObs/365, Obs3, 'g^', t/365, pk4, 'y', TObs/365, Obs4, 'y^')
    ry1 = rYieldFunc(t,pk1,rySConsts)
    ry2 = rYieldFunc(t,pk2,rySConsts)
    ry3 = rYieldFunc(t,pk3,rySConsts)
    ry4 = rYieldFunc(t,pk4,rySConsts)
    b.plot(t/365,ry1,'r',t/365,ry2,'b', t/365, ry3, 'g', t/365, ry4, 'y')
    canvas = FigureCanvasTkAgg(fig, frame)
    canvas.show()
    canvas.get_tk_widget().grid(row=0, column=0, columnspan=1, padx=10, pady=10, sticky='nsew')
    popup.mainloop()


def sh5(TObs, Obs1, Obs2, Obs3, Obs4, Obs5, t, pk1, pk2, pk3, pk4, pk5, P0, alpha, c):
    popup = tk.Tk()
    popup.wm_title('Phosphorous parametrization')
    frame = ttk.Frame(popup)
    frame.grid(row=0,column=0,padx=(20,0),pady=20)
    frame1=ttk.Frame(popup)
    frame1.grid(row=0,column=1, padx=(0,20), pady=20, sticky='n')
    parLab = ttk.LabelFrame(frame1,text='The resultant parameters:')
    parLab.grid(row=0, column=0, padx=20, pady=20,sticky='ew')

    lblOne = tk.Text(parLab, width=4,height=1,background='snow2')
    lblOne.insert(tk.INSERT,'P0 =')
    lblOne.tag_add('pn','1.0','1.1')
    lblOne.tag_add('pn1','1.2','1.4')
    lblOne.tag_add("psub",'1.1','1.2')
    lblOne.tag_configure("psub",offset=-2.3,font=SMALL_FONT)
    lblOne.tag_configure('pn',font=LARGE_FONT)
    lblOne.tag_configure('pn1',font=LARGE_FONT)
    lblOne.configure(state=tk.DISABLED,borderwidth=-3)
    lblOne.grid(row=0, column=0, padx=5, pady=5)

    lblOneAns = tk.Text(parLab, width=13,height=1)
    lblOneAns.insert(tk.INSERT,str(round(P0,2)))
    lblOneAns.configure(state=tk.DISABLED)
    lblOneAns.grid(row=0, column=1, padx=5, pady=5)

    lblOneUnit = tk.Text(parLab, width=20,height=1,background='snow2')
    lblOneUnit.insert(tk.INSERT, u'\N{GREEK SMALL LETTER MU}g P cm-3')
    lblOneUnit.tag_add("pun",'1.0','1.7')
    lblOneUnit.tag_add("pusub",'1.7','1.9')
    lblOneUnit.tag_configure("pun",font=LARGE_FONT)
    lblOneUnit.tag_configure("pusub",offset=2.3,font=SMALL_FONT)
    lblOneUnit.configure(state=tk.DISABLED,borderwidth=-3)
    lblOneUnit.grid(row=0, column=2, padx=5, pady=5)

    alphaPLab = tk.Text(parLab, width=4,height=1,background='snow2')
    alphaPLab.grid(row=1,column=0,pady=5,padx=5)
    alphaPLab.insert(tk.INSERT,u'\N{GREEK SMALL LETTER ALPHA}')
    alphaPLab.insert(tk.END,"p =")
    alphaPLab.tag_add("pan",'1.0','1.1')
    alphaPLab.tag_add("subscript",'1.1','1.2')
    alphaPLab.tag_add("pan1",'1.0','1.1')
    alphaPLab.tag_add("main",'1.2','1.4')
    alphaPLab.tag_configure("pan",font=LARGE_FONT)
    alphaPLab.tag_configure("subscript",offset=-2.3,font=SMALL_FONT)
    alphaPLab.tag_configure("pan1",font=LARGE_FONT)
    alphaPLab.tag_configure("main",font=LARGE_FONT)
    alphaPLab.configure(state=tk.DISABLED, borderwidth=-3)

        
    alphaPText = tk.Text(parLab, width=13, height=1)
    alphaPText.grid(row=1,column=1,padx=5,pady=5)
    alphaPText.insert(tk.INSERT,'{0:.4f}'.format(alpha*10**4)+' x 10-4')
    alphaPText.tag_add('a','1.11','1.13')
    alphaPText.tag_configure('a',offset=2.3,font=SMALL_FONT)
    alphaPText.configure(state=tk.DISABLED)

    alphaPLabUnit = tk.Text(parLab, width=20,height=1,background='snow2')
    alphaPLabUnit.grid(row=1,column=2,pady=5,padx=5)
    alphaPLabUnit.insert(tk.INSERT,'day-1')
    alphaPLabUnit.tag_add("paun",'1.0','1.3')
    alphaPLabUnit.tag_add("superscript",'1.3','1.5')
    alphaPLabUnit.tag_configure("paun",font=LARGE_FONT)
    alphaPLabUnit.tag_configure("superscript",offset=2.3,font=SMALL_FONT)
    
    alphaPLabUnit.configure(state=tk.DISABLED, borderwidth=-3)


    lblThree = tk.Text(parLab, width=4,height=1,background='snow2')
    lblThree.insert(tk.INSERT,'cp =')
    lblThree.tag_add("cpn",'1.0','1.1')
    lblThree.tag_add("csub",'1.1','1.2')
    lblThree.tag_add("cpn1",'1.2','1.4')
    lblThree.tag_configure("cpn",font=LARGE_FONT)
    lblThree.tag_configure("csub",offset=-2.3,font=SMALL_FONT)
    lblThree.tag_configure("cpn1",font=LARGE_FONT)
    lblThree.configure(state=tk.DISABLED,borderwidth=-3)
    lblThree.grid(row=2, column=0, padx=5, pady=5)

    
    lblThreeAns = tk.Text(parLab, width=13,height=1)
    lblThreeAns.insert(tk.INSERT,str(round(c,4)))
    lblThreeAns.configure(state=tk.DISABLED)
    lblThreeAns.grid(row=2, column=1, padx=5, pady=5)

    lblThreeUnit = tk.Text(parLab, width=20,height=1,background='snow2')
    lblThreeUnit.insert(tk.INSERT, 'Olsen P (kg P ha-1)-1')
    lblThreeUnit.tag_add("cupn",'1.0','1.16')
    lblThreeUnit.tag_add("cusup1",'1.16','1.18')
    lblThreeUnit.tag_add("cupn1",'1.18','1.19')
    lblThreeUnit.tag_add("cusup2",'1.19','1.21')
    lblThreeUnit.tag_configure("cupn",font=LARGE_FONT)
    lblThreeUnit.tag_configure("cusup1",offset=2.3,font=SMALL_FONT)
    lblThreeUnit.tag_configure("cupn1",font=LARGE_FONT)
    lblThreeUnit.tag_configure("cusup2",offset=2.3,font=SMALL_FONT)
    lblThreeUnit.configure(state=tk.DISABLED,borderwidth=-3)
    lblThreeUnit.grid(row=2, column=2, padx=5, pady=5)

    ryLab = ttk.LabelFrame(frame1,text='The resultant parameters:')
    ryLab.grid(row=1, column=0, padx=20, pady=20,sticky='ew')

    rygpLab = ttk.Label(ryLab, text='Soil Group')
    rygpLab.grid(row=0, column=0, padx=10,pady=10,sticky='e')

    rygpVar = tk.StringVar()
    rygpEnt = ttk.Combobox(ryLab, textvariable=rygpVar, width=10, state='readonly')
    rygpEnt['values'] = ['Sedimentary', 'Volcanic', 'Pumice', 'Recent', 'Podzols','Sands']
    rygpEnt.current(0)
    rygpEnt.grid(row=0, column=1, padx=10, pady=10)

    def plotRY():
        if rygpEnt.get() == 'Sedimentary':
            ryConsts = np.array((104.61,0,2.60),dtype=float)
        elif rygpEnt.get() == 'Volcanic':
            ryConsts = np.array((108.60,10.44,17.22),dtype=float)
        elif rygpEnt.get() == 'Pumice':
            ryConsts = np.array((106.60,15.52,23.41),dtype=float)
        elif rygpEnt.get() == 'Recent':
            ryConsts = np.array((105.00,28.49,34.75),dtype=float)
        elif rygpEnt.get() == 'Podzols':
            ryConsts = np.array((199.91,107.42,255.51),dtype=float)
        elif rygpEnt.get() == 'Sands':
            ryConsts = np.array((105.48,0.00,1.40),dtype=float)

        ry1 = rYieldFunc(t,pk1,ryConsts)
        ry2 = rYieldFunc(t,pk2,ryConsts)
        ry3 = rYieldFunc(t,pk3,ryConsts)
        ry4 = rYieldFunc(t,pk4,ryConsts)
        ry5 = rYieldFunc(t,pk5,ryConsts)
        b.plot(t/365,ry1,'r',t/365,ry2,'b', t/365, ry3, 'g', t/365, ry4, 'y', t/365, ry5, 'm')
        canvas = FigureCanvasTkAgg(fig, frame)
        canvas.show()
        canvas.get_tk_widget().grid(row=0, column=0, columnspan=1, padx=10, pady=10, sticky='nsew')

    ryBtn = tk.Button(ryLab, text='Plot RY', command=plotRY)
    ryBtn.grid(row=0, column=2, padx=10,pady=10)
    
    fig = Figure(figsize=(5,6), dpi=80)
    a = fig.add_subplot(211)
    a.axis([TObs[0]/365, TObs[-1]/365 + 0.5, 0, max(max(Obs1),max(Obs2), max(Obs3),max(Obs4),max(Obs5),max(pk5))+5])
    a.xaxis.set_major_formatter(matplotlib.ticker.FormatStrFormatter('%.0f'))
    a.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=True))
    a.set_ylabel('Olsen P')
    b = fig.add_subplot(212)
    b.axis([TObs[0]/365, TObs[-1]/365 + 0.5, 50, 105])
    b.xaxis.set_major_formatter(matplotlib.ticker.FormatStrFormatter('%.0f'))
    b.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=True))
    b.set_ylabel('RY')
    b.set_xlabel('Years')
            
    a.plot(t/365, pk1, 'r', TObs/365, Obs1, 'r^', t/365, pk2, 'b', TObs/365, Obs2, 'b^', t/365, pk3, 'g', TObs/365, Obs3, 'g^', t/365, pk4, 'y', TObs/365, Obs4, 'y^', t/365, pk5, 'm', TObs/365, Obs5, 'm^')
    canvas = FigureCanvasTkAgg(fig, frame)
    canvas.show()
    canvas.get_tk_widget().grid(row=0, column=0, columnspan=1, padx=10, pady=10, sticky='nsew')
    popup.mainloop()

def sh5k(TObs, Obs1, Obs2,Obs3, Obs4, Obs5, t, pk1,pk2, pk3, pk4, pk5, K0, alpha, c):
    popup = tk.Tk()
    popup.wm_title('Potassium parametrisation')
    frame = ttk.Frame(popup)
    frame.grid(row=0,column=0,padx=(20,0),pady=20)
    frame1=ttk.Frame(popup)
    frame1.grid(row=0,column=1, padx=(0,20), pady=20, sticky='n')
    parLab = ttk.LabelFrame(frame1,text='The resultant parameters:')
    parLab.grid(row=0, column=0, padx=20, pady=20,sticky='ew')

    lblOne = tk.Text(parLab, width=4,height=1,background='snow2')
    lblOne.insert(tk.INSERT,'K0 =')
    lblOne.tag_add("kn",'1.0','1.1')
    lblOne.tag_add("ksub",'1.1','1.2')
    lblOne.tag_add("kn1",'1.2','1.4')
    lblOne.tag_configure("kn",font=LARGE_FONT)
    lblOne.tag_configure("ksub",offset=-2.3,font=SMALL_FONT)
    lblOne.tag_configure("kn1",font=LARGE_FONT)
    lblOne.configure(state=tk.DISABLED,borderwidth=-3)
    lblOne.grid(row=0, column=0, padx=5, pady=5)

    lblOneAns = tk.Text(parLab, width=13,height=1)
    lblOneAns.insert(tk.INSERT,str(round(K0,2)))
    lblOneAns.configure(state=tk.DISABLED)
    lblOneAns.grid(row=0, column=1, padx=5, pady=5)

    lblOneUnit = tk.Text(parLab, width=21,height=1,background='snow2')
    lblOneUnit.insert(tk.INSERT, 'cmol(+) kg-1 x 24.375')
    lblOneUnit.tag_add("kun",'1.0','1.10')
    lblOneUnit.tag_add("kusup",'1.10','1.12')
    lblOneUnit.tag_add("kun1",'1.12','1.21')
    lblOneUnit.tag_configure("kun",font=LARGE_FONT)
    lblOneUnit.tag_configure("kusup",offset=2.3,font=SMALL_FONT)
    lblOneUnit.tag_configure("kun1",font=LARGE_FONT)
    lblOneUnit.configure(state=tk.DISABLED,borderwidth=-3)
    lblOneUnit.grid(row=0, column=2, padx=5, pady=5)

    alphaPLab = tk.Text(parLab, width=4,height=1,background='snow2')
    alphaPLab.grid(row=1,column=0,pady=5,padx=5)
    alphaPLab.insert(tk.INSERT,u'\N{GREEK SMALL LETTER ALPHA}')
    alphaPLab.insert(tk.END,"k =")
    alphaPLab.tag_add("kan",'1.0','1.1')
    alphaPLab.tag_add("subscript",'1.1','1.2')
    alphaPLab.tag_add("kan1",'1.2','1.4')
    alphaPLab.tag_configure("kan",font=LARGE_FONT)
    alphaPLab.tag_configure("subscript",offset=-2.3,font=SMALL_FONT)
    alphaPLab.tag_configure("kan1",font=LARGE_FONT)
    alphaPLab.configure(state=tk.DISABLED, borderwidth=-3)

        
    alphaPText = tk.Text(parLab, width=13, height=1)
    alphaPText.grid(row=1,column=1,padx=5,pady=5)
    alphaPText.insert(tk.INSERT,'{0:.4f}'.format(alpha*10**4)+' x 10-4')
    alphaPText.tag_add('a','1.11','1.13')
    alphaPText.tag_configure('a',offset=2.3,font=SMALL_FONT)
    alphaPText.configure(state=tk.DISABLED)

    alphaPLabUnit = tk.Text(parLab, width=21,height=1,background='snow2')
    alphaPLabUnit.grid(row=1,column=2,pady=5,padx=5)
    alphaPLabUnit.insert(tk.INSERT,'day-1')
    alphaPLabUnit.tag_add("kaun",'1.0','1.3')
    alphaPLabUnit.tag_add("superscript",'1.3','1.5')
    alphaPLabUnit.tag_configure("kaun",font=LARGE_FONT)
    alphaPLabUnit.tag_configure("superscript",offset=2.3,font=SMALL_FONT)
    alphaPLabUnit.configure(state=tk.DISABLED, borderwidth=-3)


    lblThree = tk.Text(parLab, width=4,height=1,background='snow2')
    lblThree.insert(tk.INSERT,'ck =')
    lblThree.tag_add("ckn",'1.0','1.1')
    lblThree.tag_add("csub",'1.1','1.2')
    lblThree.tag_add("ckn1",'1.2','1.4')
    lblThree.tag_configure("ckn",font=LARGE_FONT)
    lblThree.tag_configure("csub",offset=-2.3,font=SMALL_FONT)
    lblThree.tag_configure("ckn1",font=LARGE_FONT)
    lblThree.configure(state=tk.DISABLED,borderwidth=-3)
    lblThree.grid(row=2, column=0, padx=5, pady=5)

    
    lblThreeAns = tk.Text(parLab, width=13,height=1)
    lblThreeAns.insert(tk.INSERT,str(round(c,4)))
    lblThreeAns.configure(state=tk.DISABLED)
    lblThreeAns.grid(row=2, column=1, padx=5, pady=5)

    lblThreeUnit = tk.Text(parLab, width=21,height=1,background='snow2')
    lblThreeUnit.insert(tk.INSERT, 'QTK (kg K ha-1)-1')
    lblThreeUnit.tag_add("cukn",'1.0','1.12')
    lblThreeUnit.tag_add("cusup1",'1.12','1.14')
    lblThreeUnit.tag_add("cukn1",'1.14','1.15')
    lblThreeUnit.tag_add("cusup2",'1.15','1.17')
    lblThreeUnit.tag_configure("cukn",font=LARGE_FONT)
    lblThreeUnit.tag_configure("cusup1",offset=2.3,font=SMALL_FONT)
    lblThreeUnit.tag_configure("cukn1",font=LARGE_FONT)
    lblThreeUnit.tag_configure("cusup2",offset=2.3,font=SMALL_FONT)
    lblThreeUnit.configure(state=tk.DISABLED,borderwidth=-3)
    lblThreeUnit.grid(row=2, column=2, padx=5, pady=5)

    
    ryKConsts = np.array([125.09, 4.24, 7.84])
    

    
    fig = Figure(figsize=(5,6), dpi=80)
    a = fig.add_subplot(211)
    a.axis([TObs[0]/365, TObs[-1]/365 + 0.5, 0, max(max(Obs1),max(Obs2),max(Obs3),max(Obs4),max(Obs5),max(pk5)) + 5])
    a.xaxis.set_major_formatter(matplotlib.ticker.FormatStrFormatter('%.0f'))
    a.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=True))
    a.set_ylabel('QTK')
    b = fig.add_subplot(212)
    b.axis([TObs[0]/365, TObs[-1]/365 + 0.5, 50, 105])
    b.xaxis.set_major_formatter(matplotlib.ticker.FormatStrFormatter('%.0f'))
    b.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=True))
    b.set_ylabel('RY')
    b.set_xlabel('Years')
            
    a.plot(t/365, pk1, 'r', TObs/365, Obs1, 'r^', t/365, pk2, 'b', TObs/365, Obs2, 'b^', t/365, pk3, 'g', TObs/365, Obs3, 'g^', t/365, pk4, 'y', TObs/365, Obs4, 'y^', t/365, pk5, 'm', TObs/365, Obs5, 'm^')
    ry1 = rYieldFunc(t,pk1,ryKConsts)
    ry2 = rYieldFunc(t,pk2,ryKConsts)
    ry3 = rYieldFunc(t,pk3,ryKConsts)
    ry4 = rYieldFunc(t,pk4,ryKConsts)
    ry5 = rYieldFunc(t,pk5,ryKConsts)
    b.plot(t/365,ry1,'r',t/365,ry2,'b', t/365, ry3, 'g', t/365, ry4, 'y', t/365, ry5, 'm')
    canvas = FigureCanvasTkAgg(fig, frame)
    canvas.show()
    canvas.get_tk_widget().grid(row=0, column=0, columnspan=1, padx=10, pady=10, sticky='nsew')
    popup.mainloop()


def sh5s(TObs, Obs1, Obs2,Obs3, Obs4, Obs5, t, pk1,pk2, pk3, pk4, pk5, K0, alpha, c):
    popup = tk.Tk()
    popup.wm_title('Sulphur parametrisation')
    frame = ttk.Frame(popup)
    frame.grid(row=0,column=0,padx=(20,0),pady=20)
    frame1=ttk.Frame(popup)
    frame1.grid(row=0,column=1, padx=(0,20), pady=20, sticky='n')
    parLab = ttk.LabelFrame(frame1,text='The resultant parameters:')
    parLab.grid(row=0, column=0, padx=20, pady=20,sticky='ew')

    lblOne = tk.Text(parLab, width=4,height=1,background='snow2')
    lblOne.insert(tk.INSERT,'S0 =')
    lblOne.tag_add("sn",'1.0','1.1')
    lblOne.tag_add("ssub",'1.1','1.2')
    lblOne.tag_add("sn1",'1.2','1.4')
    lblOne.tag_configure("sn",font=LARGE_FONT)
    lblOne.tag_configure("ssub",offset=-2.3,font=SMALL_FONT)
    lblOne.tag_configure("sn1",font=LARGE_FONT)
    lblOne.configure(state=tk.DISABLED,borderwidth=-3)
    lblOne.grid(row=0, column=0, padx=5, pady=5)

    lblOneAns = tk.Text(parLab, width=13,height=1)
    lblOneAns.insert(tk.INSERT,str(round(S0,2)))
    lblOneAns.configure(state=tk.DISABLED)
    lblOneAns.grid(row=0, column=1, padx=5, pady=5)

    lblOneUnit = tk.Text(parLab, width=21,height=1,background='snow2')
    lblOneUnit.insert(tk.INSERT, u'\N{GREEK SMALL LETTER MU}g S g-1')
    lblOneUnit.tag_add("sun",'1.0','1.6')
    lblOneUnit.tag_add("susup",'1.6','1.8')
    lblOneUnit.tag_configure("sun",font=LARGE_FONT)
    lblOneUnit.tag_configure("susup",offset=2.3,font=SMALL_FONT)
    lblOneUnit.configure(state=tk.DISABLED,borderwidth=-3)
    lblOneUnit.grid(row=0, column=2, padx=5, pady=5)

    alphaPLab = tk.Text(parLab, width=4,height=1,background='snow2')
    alphaPLab.grid(row=1,column=0,pady=5,padx=5)
    alphaPLab.insert(tk.INSERT,u'\N{GREEK SMALL LETTER ALPHA}')
    alphaPLab.insert(tk.END,"s =")
    alphaPLab.tag_add("san",'1.0','1.1')
    alphaPLab.tag_add("subscript",'1.1','1.2')
    alphaPLab.tag_add("san1",'1.2','1.4')
    alphaPLab.tag_configure("san",font=LARGE_FONT)
    alphaPLab.tag_configure("subscript",offset=-2.3,font=SMALL_FONT)
    alphaPLab.tag_configure("san1",font=LARGE_FONT)
    alphaPLab.configure(state=tk.DISABLED, borderwidth=-3)

        
    alphaPText = tk.Text(parLab, width=13, height=1)
    alphaPText.grid(row=1,column=1,padx=5,pady=5)
    alphaPText.insert(tk.INSERT,'{0:.4f}'.format(alpha*10**4)+' x 10-4')
    alphaPText.tag_add('a','1.11','1.13')
    alphaPText.tag_configure('a',offset=2.3,font=SMALL_FONT)
    alphaPText.configure(state=tk.DISABLED)

    alphaPLabUnit = tk.Text(parLab, width=21,height=1,background='snow2')
    alphaPLabUnit.grid(row=1,column=2,pady=5,padx=5)
    alphaPLabUnit.insert(tk.INSERT,'day-1')
    alphaPLabUnit.tag_add("saun",'1.0','1.3')
    alphaPLabUnit.tag_add("superscript",'1.3','1.5')
    alphaPLabUnit.tag_configure("saun",font=LARGE_FONT)
    alphaPLabUnit.tag_configure("superscript",offset=2.3,font=SMALL_FONT)
    alphaPLabUnit.configure(state=tk.DISABLED, borderwidth=-3)


    lblThree = tk.Text(parLab, width=4,height=1,background='snow2')
    lblThree.insert(tk.INSERT,'cs =')
    lblThree.tag_add("csn",'1.0','1.1')
    lblThree.tag_add("csub",'1.1','1.2')
    lblThree.tag_add("csn1",'1.2','1.4')
    lblThree.tag_configure("csn",font=LARGE_FONT)
    lblThree.tag_configure("csub",offset=-2.3,font=SMALL_FONT)
    lblThree.tag_configure("csn1",font=LARGE_FONT)
    lblThree.configure(state=tk.DISABLED,borderwidth=-3)
    lblThree.grid(row=2, column=0, padx=5, pady=5)

    
    lblThreeAns = tk.Text(parLab, width=13,height=1)
    lblThreeAns.insert(tk.INSERT,str(round(c,4)))
    lblThreeAns.configure(state=tk.DISABLED)
    lblThreeAns.grid(row=2, column=1, padx=5, pady=5)

    lblThreeUnit = tk.Text(parLab, width=21,height=1,background='snow2')
    lblThreeUnit.insert(tk.INSERT, 'EOS (kg S ha-1)-1')
    lblThreeUnit.tag_add("cusn",'1.0','1.12')
    lblThreeUnit.tag_add("cusup1",'1.12','1.14')
    lblThreeUnit.tag_add("cusn1",'1.14','1.15')
    lblThreeUnit.tag_add("cusup2",'1.15','1.17')
    lblThreeUnit.tag_configure("cusn",font=LARGE_FONT)
    lblThreeUnit.tag_configure("cusup1",offset=2.3,font=SMALL_FONT)
    lblThreeUnit.tag_configure("cusn1",font=LARGE_FONT)
    lblThreeUnit.tag_configure("cusup2",offset=2.3,font=SMALL_FONT)
    lblThreeUnit.configure(state=tk.DISABLED,borderwidth=-3)
    lblThreeUnit.grid(row=2, column=2, padx=5, pady=5)

    
    rySConsts = np.array([183.80, 0.09, 10.49])
    

    
    fig = Figure(figsize=(5,6), dpi=80)
    a = fig.add_subplot(211)
    a.axis([TObs[0]/365, TObs[-1]/365 + 0.5, 0, max(max(Obs1),max(Obs2),max(Obs3),max(Obs4),max(Obs5),max(pk5)) + 5])
    a.xaxis.set_major_formatter(matplotlib.ticker.FormatStrFormatter('%.0f'))
    a.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=True))
    a.set_ylabel('EOS')
    b = fig.add_subplot(212)
    b.axis([TObs[0]/365, TObs[-1]/365 + 0.5, 50, 105])
    b.xaxis.set_major_formatter(matplotlib.ticker.FormatStrFormatter('%.0f'))
    b.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=True))
    b.set_ylabel('RY')
    b.set_xlabel('Years')
            
    a.plot(t/365, pk1, 'r', TObs/365, Obs1, 'r^', t/365, pk2, 'b', TObs/365, Obs2, 'b^', t/365, pk3, 'g', TObs/365, Obs3, 'g^', t/365, pk4, 'y', TObs/365, Obs4, 'y^', t/365, pk5, 'm', TObs/365, Obs5, 'm^')
    ry1 = rYieldFunc(t,pk1,rySConsts)
    ry2 = rYieldFunc(t,pk2,rySConsts)
    ry3 = rYieldFunc(t,pk3,rySConsts)
    ry4 = rYieldFunc(t,pk4,rySConsts)
    ry5 = rYieldFunc(t,pk5,rySConsts)
    b.plot(t/365,ry1,'r',t/365,ry2,'b', t/365, ry3, 'g', t/365, ry4, 'y', t/365, ry5, 'm')
    canvas = FigureCanvasTkAgg(fig, frame)
    canvas.show()
    canvas.get_tk_widget().grid(row=0, column=0, columnspan=1, padx=10, pady=10, sticky='nsew')
    popup.mainloop()

def sh6(TObs, Obs1, Obs2, Obs3, Obs4, Obs5, Obs6, t, pk1, pk2, pk3, pk4, pk5, pk6, P0, alpha, c):
    popup = tk.Tk()
    popup.wm_title('Phosphorous parametrization')
    frame = ttk.Frame(popup)
    frame.grid(row=0,column=0,padx=(20,0),pady=20)
    frame1=ttk.Frame(popup)
    frame1.grid(row=0,column=1, padx=(0,20), pady=20, sticky='n')
    parLab = ttk.LabelFrame(frame1,text='The resultant parameters:')
    parLab.grid(row=0, column=0, padx=20, pady=20,sticky='ew')

    lblOne = tk.Text(parLab, width=4,height=1,background='snow2')
    lblOne.insert(tk.INSERT,'P0 =')
    lblOne.tag_add('pn','1.0','1.1')
    lblOne.tag_add('pn1','1.2','1.4')
    lblOne.tag_add("psub",'1.1','1.2')
    lblOne.tag_configure("psub",offset=-2.3,font=SMALL_FONT)
    lblOne.tag_configure('pn',font=LARGE_FONT)
    lblOne.tag_configure('pn1',font=LARGE_FONT)
    lblOne.configure(state=tk.DISABLED,borderwidth=-3)
    lblOne.grid(row=0, column=0, padx=5, pady=5)

    lblOneAns = tk.Text(parLab, width=13,height=1)
    lblOneAns.insert(tk.INSERT,str(round(P0,2)))
    lblOneAns.configure(state=tk.DISABLED)
    lblOneAns.grid(row=0, column=1, padx=5, pady=5)

    lblOneUnit = tk.Text(parLab, width=20,height=1,background='snow2')
    lblOneUnit.insert(tk.INSERT, u'\N{GREEK SMALL LETTER MU}g P cm-3')
    lblOneUnit.tag_add("pun",'1.0','1.7')
    lblOneUnit.tag_add("pusub",'1.7','1.9')
    lblOneUnit.tag_configure("pun",font=LARGE_FONT)
    lblOneUnit.tag_configure("pusub",offset=2.3,font=SMALL_FONT)
    lblOneUnit.configure(state=tk.DISABLED,borderwidth=-3)
    lblOneUnit.grid(row=0, column=2, padx=5, pady=5)

    alphaPLab = tk.Text(parLab, width=4,height=1,background='snow2')
    alphaPLab.grid(row=1,column=0,pady=5,padx=5)
    alphaPLab.insert(tk.INSERT,u'\N{GREEK SMALL LETTER ALPHA}')
    alphaPLab.insert(tk.END,"p =")
    alphaPLab.tag_add("pan",'1.0','1.1')
    alphaPLab.tag_add("subscript",'1.1','1.2')
    alphaPLab.tag_add("pan1",'1.0','1.1')
    alphaPLab.tag_add("main",'1.2','1.4')
    alphaPLab.tag_configure("pan",font=LARGE_FONT)
    alphaPLab.tag_configure("subscript",offset=-2.3,font=SMALL_FONT)
    alphaPLab.tag_configure("pan1",font=LARGE_FONT)
    alphaPLab.tag_configure("main",font=LARGE_FONT)
    alphaPLab.configure(state=tk.DISABLED, borderwidth=-3)

        
    alphaPText = tk.Text(parLab, width=13, height=1)
    alphaPText.grid(row=1,column=1,padx=5,pady=5)
    alphaPText.insert(tk.INSERT,'{0:.4f}'.format(alpha*10**4)+' x 10-4')
    alphaPText.tag_add('a','1.11','1.13')
    alphaPText.tag_configure('a',offset=2.3,font=SMALL_FONT)
    alphaPText.configure(state=tk.DISABLED)

    alphaPLabUnit = tk.Text(parLab, width=20,height=1,background='snow2')
    alphaPLabUnit.grid(row=1,column=2,pady=5,padx=5)
    alphaPLabUnit.insert(tk.INSERT,'day-1')
    alphaPLabUnit.tag_add("paun",'1.0','1.3')
    alphaPLabUnit.tag_add("superscript",'1.3','1.5')
    alphaPLabUnit.tag_configure("paun",font=LARGE_FONT)
    alphaPLabUnit.tag_configure("superscript",offset=2.3,font=SMALL_FONT)
    
    alphaPLabUnit.configure(state=tk.DISABLED, borderwidth=-3)


    lblThree = tk.Text(parLab, width=4,height=1,background='snow2')
    lblThree.insert(tk.INSERT,'cp =')
    lblThree.tag_add("cpn",'1.0','1.1')
    lblThree.tag_add("csub",'1.1','1.2')
    lblThree.tag_add("cpn1",'1.2','1.4')
    lblThree.tag_configure("cpn",font=LARGE_FONT)
    lblThree.tag_configure("csub",offset=-2.3,font=SMALL_FONT)
    lblThree.tag_configure("cpn1",font=LARGE_FONT)
    lblThree.configure(state=tk.DISABLED,borderwidth=-3)
    lblThree.grid(row=2, column=0, padx=5, pady=5)

    
    lblThreeAns = tk.Text(parLab, width=13,height=1)
    lblThreeAns.insert(tk.INSERT,str(round(c,4)))
    lblThreeAns.configure(state=tk.DISABLED)
    lblThreeAns.grid(row=2, column=1, padx=5, pady=5)

    lblThreeUnit = tk.Text(parLab, width=20,height=1,background='snow2')
    lblThreeUnit.insert(tk.INSERT, 'Olsen P (kg P ha-1)-1')
    lblThreeUnit.tag_add("cupn",'1.0','1.16')
    lblThreeUnit.tag_add("cusup1",'1.16','1.18')
    lblThreeUnit.tag_add("cupn1",'1.18','1.19')
    lblThreeUnit.tag_add("cusup2",'1.19','1.21')
    lblThreeUnit.tag_configure("cupn",font=LARGE_FONT)
    lblThreeUnit.tag_configure("cusup1",offset=2.3,font=SMALL_FONT)
    lblThreeUnit.tag_configure("cupn1",font=LARGE_FONT)
    lblThreeUnit.tag_configure("cusup2",offset=2.3,font=SMALL_FONT)
    lblThreeUnit.configure(state=tk.DISABLED,borderwidth=-3)
    lblThreeUnit.grid(row=2, column=2, padx=5, pady=5)

    ryLab = ttk.LabelFrame(frame1,text='The resultant parameters:')
    ryLab.grid(row=1, column=0, padx=20, pady=20,sticky='ew')

    rygpLab = ttk.Label(ryLab, text='Soil Group')
    rygpLab.grid(row=0, column=0, padx=10,pady=10,sticky='e')

    rygpVar = tk.StringVar()
    rygpEnt = ttk.Combobox(ryLab, textvariable=rygpVar, width=10, state='readonly')
    rygpEnt['values'] = ['Sedimentary', 'Volcanic', 'Pumice', 'Recent', 'Podzols','Sands']
    rygpEnt.current(0)
    rygpEnt.grid(row=0, column=1, padx=10, pady=10)

    def plotRY():
        if rygpEnt.get() == 'Sedimentary':
            ryConsts = np.array((104.61,0,2.60),dtype=float)
        elif rygpEnt.get() == 'Volcanic':
            ryConsts = np.array((108.60,10.44,17.22),dtype=float)
        elif rygpEnt.get() == 'Pumice':
            ryConsts = np.array((106.60,15.52,23.41),dtype=float)
        elif rygpEnt.get() == 'Recent':
            ryConsts = np.array((105.00,28.49,34.75),dtype=float)
        elif rygpEnt.get() == 'Podzols':
            ryConsts = np.array((199.91,107.42,255.51),dtype=float)
        elif rygpEnt.get() == 'Sands':
            ryConsts = np.array((105.48,0.00,1.40),dtype=float)

        ry1 = rYieldFunc(t,pk1,ryConsts)
        ry2 = rYieldFunc(t,pk2,ryConsts)
        ry3 = rYieldFunc(t,pk3,ryConsts)
        ry4 = rYieldFunc(t,pk4,ryConsts)
        ry5 = rYieldFunc(t,pk5,ryConsts)
        ry6 = rYieldFunc(t,pk6,ryConsts)
        b.plot(t/365,ry1,'r',t/365,ry2,'b', t/365, ry3, 'g', t/365, ry4, 'y', t/365, ry5, 'm', t/365, ry6, 'c')
        canvas = FigureCanvasTkAgg(fig, frame)
        canvas.show()
        canvas.get_tk_widget().grid(row=0, column=0, columnspan=1, padx=10, pady=10, sticky='nsew')

    ryBtn = tk.Button(ryLab, text='Plot RY', command=plotRY)
    ryBtn.grid(row=0, column=2, padx=10,pady=10)
    
    fig = Figure(figsize=(5,6), dpi=80)
    a = fig.add_subplot(211)
    a.axis([TObs[0]/365-.3, TObs[-1]/365 + 0.5, 0, max(max(Obs1),max(Obs2), max(Obs3),max(Obs4),max(Obs5),max(Obs6),max(pk6))+5])
    a.xaxis.set_major_formatter(matplotlib.ticker.FormatStrFormatter('%.0f'))
    a.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=True))
    a.set_ylabel('Olsen P')
    b = fig.add_subplot(212)
    b.axis([TObs[0]/365-.3, TObs[-1]/365 + 0.5, 50, 105])
    b.xaxis.set_major_formatter(matplotlib.ticker.FormatStrFormatter('%.0f'))
    b.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=True))
    b.set_ylabel('RY')
    b.set_xlabel('Years')
            
    a.plot(t/365, pk1, 'r', TObs/365, Obs1, 'r^', t/365, pk2, 'b', TObs/365, Obs2, 'b^', t/365, pk3, 'g', TObs/365, Obs3, 'g^', t/365, pk4, 'y', TObs/365, Obs4, 'y^', t/365, pk5, 'm', TObs/365, Obs5, 'm^', t/365, pk6, 'c', TObs/365, Obs6, 'c^')
    canvas = FigureCanvasTkAgg(fig, frame)
    canvas.show()
    canvas.get_tk_widget().grid(row=0, column=0, columnspan=1, padx=10, pady=10, sticky='nsew')
    popup.mainloop()



def sh6k(TObs, Obs1, Obs2,Obs3, Obs4, Obs5, Obs6, t, pk1,pk2, pk3, pk4, pk5, pk6, K0, alpha, c):
    popup = tk.Tk()
    popup.wm_title('Potassium parametrisation')
    frame = ttk.Frame(popup)
    frame.grid(row=0,column=0,padx=(20,0),pady=20)
    frame1=ttk.Frame(popup)
    frame1.grid(row=0,column=1, padx=(0,20), pady=20, sticky='n')
    parLab = ttk.LabelFrame(frame1,text='The resultant parameters:')
    parLab.grid(row=0, column=0, padx=20, pady=20,sticky='ew')


    lblOne = tk.Text(parLab, width=4,height=1,background='snow2')
    lblOne.insert(tk.INSERT,'K0 =')
    lblOne.tag_add("kn",'1.0','1.1')
    lblOne.tag_add("ksub",'1.1','1.2')
    lblOne.tag_add("kn1",'1.2','1.4')
    lblOne.tag_configure("kn",font=LARGE_FONT)
    lblOne.tag_configure("ksub",offset=-2.3,font=SMALL_FONT)
    lblOne.tag_configure("kn1",font=LARGE_FONT)
    lblOne.configure(state=tk.DISABLED,borderwidth=-3)
    lblOne.grid(row=0, column=0, padx=5, pady=5)

    lblOneAns = tk.Text(parLab, width=13,height=1)
    lblOneAns.insert(tk.INSERT,str(round(K0,2)))
    lblOneAns.configure(state=tk.DISABLED)
    lblOneAns.grid(row=0, column=1, padx=5, pady=5)

    lblOneUnit = tk.Text(parLab, width=21,height=1,background='snow2')
    lblOneUnit.insert(tk.INSERT, 'cmol(+) kg-1 x 24.375')
    lblOneUnit.tag_add("kun",'1.0','1.10')
    lblOneUnit.tag_add("kusup",'1.10','1.12')
    lblOneUnit.tag_add("kun1",'1.12','1.21')
    lblOneUnit.tag_configure("kun",font=LARGE_FONT)
    lblOneUnit.tag_configure("kusup",offset=2.3,font=SMALL_FONT)
    lblOneUnit.tag_configure("kun1",font=LARGE_FONT)
    lblOneUnit.configure(state=tk.DISABLED,borderwidth=-3)
    lblOneUnit.grid(row=0, column=2, padx=5, pady=5)

    alphaPLab = tk.Text(parLab, width=4,height=1,background='snow2')
    alphaPLab.grid(row=1,column=0,pady=5,padx=5)
    alphaPLab.insert(tk.INSERT,u'\N{GREEK SMALL LETTER ALPHA}')
    alphaPLab.insert(tk.END,"k =")
    alphaPLab.tag_add("kan",'1.0','1.1')
    alphaPLab.tag_add("subscript",'1.1','1.2')
    alphaPLab.tag_add("kan1",'1.2','1.4')
    alphaPLab.tag_configure("kan",font=LARGE_FONT)
    alphaPLab.tag_configure("subscript",offset=-2.3,font=SMALL_FONT)
    alphaPLab.tag_configure("kan1",font=LARGE_FONT)
    alphaPLab.configure(state=tk.DISABLED, borderwidth=-3)

        
    alphaPText = tk.Text(parLab, width=13, height=1)
    alphaPText.grid(row=1,column=1,padx=5,pady=5)
    alphaPText.insert(tk.INSERT,'{0:.4f}'.format(alpha*10**4)+' x 10-4')
    alphaPText.tag_add('a','1.11','1.13')
    alphaPText.tag_configure('a',offset=2.3,font=SMALL_FONT)
    alphaPText.configure(state=tk.DISABLED)

    alphaPLabUnit = tk.Text(parLab, width=21,height=1,background='snow2')
    alphaPLabUnit.grid(row=1,column=2,pady=5,padx=5)
    alphaPLabUnit.insert(tk.INSERT,'day-1')
    alphaPLabUnit.tag_add("kaun",'1.0','1.3')
    alphaPLabUnit.tag_add("superscript",'1.3','1.5')
    alphaPLabUnit.tag_configure("kaun",font=LARGE_FONT)
    alphaPLabUnit.tag_configure("superscript",offset=2.3,font=SMALL_FONT)
    alphaPLabUnit.configure(state=tk.DISABLED, borderwidth=-3)


    lblThree = tk.Text(parLab, width=4,height=1,background='snow2')
    lblThree.insert(tk.INSERT,'ck =')
    lblThree.tag_add("ckn",'1.0','1.1')
    lblThree.tag_add("csub",'1.1','1.2')
    lblThree.tag_add("ckn1",'1.2','1.4')
    lblThree.tag_configure("ckn",font=LARGE_FONT)
    lblThree.tag_configure("csub",offset=-2.3,font=SMALL_FONT)
    lblThree.tag_configure("ckn1",font=LARGE_FONT)
    lblThree.configure(state=tk.DISABLED,borderwidth=-3)
    lblThree.grid(row=2, column=0, padx=5, pady=5)

    
    lblThreeAns = tk.Text(parLab, width=13,height=1)
    lblThreeAns.insert(tk.INSERT,str(round(c,4)))
    lblThreeAns.configure(state=tk.DISABLED)
    lblThreeAns.grid(row=2, column=1, padx=5, pady=5)

    lblThreeUnit = tk.Text(parLab, width=21,height=1,background='snow2')
    lblThreeUnit.insert(tk.INSERT, 'QTK (kg K ha-1)-1')
    lblThreeUnit.tag_add("cukn",'1.0','1.12')
    lblThreeUnit.tag_add("cusup1",'1.12','1.14')
    lblThreeUnit.tag_add("cukn1",'1.14','1.15')
    lblThreeUnit.tag_add("cusup2",'1.15','1.17')
    lblThreeUnit.tag_configure("cukn",font=LARGE_FONT)
    lblThreeUnit.tag_configure("cusup1",offset=2.3,font=SMALL_FONT)
    lblThreeUnit.tag_configure("cukn1",font=LARGE_FONT)
    lblThreeUnit.tag_configure("cusup2",offset=2.3,font=SMALL_FONT)
    lblThreeUnit.configure(state=tk.DISABLED,borderwidth=-3)
    lblThreeUnit.grid(row=2, column=2, padx=5, pady=5)

    
    ryKConsts = np.array([125.09, 4.24, 7.84])
    

    
    fig = Figure(figsize=(5,6), dpi=80)
    a = fig.add_subplot(211)
    a.axis([TObs[0]/365, TObs[-1]/365 + 0.5, 0, max(max(Obs1),max(Obs2),max(Obs3),max(Obs4),max(Obs5),max(Obs6),max(pk6)) + 5])
    a.xaxis.set_major_formatter(matplotlib.ticker.FormatStrFormatter('%.0f'))
    a.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=True))
    a.set_ylabel('QTK')
    b = fig.add_subplot(212)
    b.axis([TObs[0]/365, TObs[-1]/365 + 0.5, 50, 105])
    b.xaxis.set_major_formatter(matplotlib.ticker.FormatStrFormatter('%.0f'))
    b.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=True))
    b.set_ylabel('RY')
    b.set_xlabel('Years')
            
    a.plot(t/365, pk1, 'r', TObs/365, Obs1, 'r^', t/365, pk2, 'b', TObs/365, Obs2, 'b^', t/365, pk3, 'g', TObs/365, Obs3, 'g^', t/365, pk4, 'y', TObs/365, Obs4, 'y^', t/365, pk5, 'm', TObs/365, Obs5, 'm^', t/365, pk6, 'c', TObs/365, Obs6, 'c^')
    ry1 = rYieldFunc(t,pk1,ryKConsts)
    ry2 = rYieldFunc(t,pk2,ryKConsts)
    ry3 = rYieldFunc(t,pk3,ryKConsts)
    ry4 = rYieldFunc(t,pk4,ryKConsts)
    ry5 = rYieldFunc(t,pk5,ryKConsts)
    ry6 = rYieldFunc(t,pk6,ryKConsts)
    b.plot(t/365,ry1,'r',t/365,ry2,'b', t/365, ry3, 'g', t/365, ry4, 'y', t/365, ry5, 'm', t/365, ry6, 'c')
    canvas = FigureCanvasTkAgg(fig, frame)
    canvas.show()
    canvas.get_tk_widget().grid(row=0, column=0, columnspan=1, padx=10, pady=10, sticky='nsew')
    popup.mainloop()


def sh6s(TObs, Obs1, Obs2,Obs3, Obs4, Obs5, Obs6, t, pk1,pk2, pk3, pk4, pk5, pk6, K0, alpha, c):
    popup = tk.Tk()
    popup.wm_title('Sulphur parametrisation')
    frame = ttk.Frame(popup)
    frame.grid(row=0,column=0,padx=(20,0),pady=20)
    frame1=ttk.Frame(popup)
    frame1.grid(row=0,column=1, padx=(0,20), pady=20, sticky='n')
    parLab = ttk.LabelFrame(frame1,text='The resultant parameters:')
    parLab.grid(row=0, column=0, padx=20, pady=20,sticky='ew')

    lblOne = tk.Text(parLab, width=4,height=1,background='snow2')
    lblOne.insert(tk.INSERT,'S0 =')
    lblOne.tag_add("sn",'1.0','1.1')
    lblOne.tag_add("ssub",'1.1','1.2')
    lblOne.tag_add("sn1",'1.2','1.4')
    lblOne.tag_configure("sn",font=LARGE_FONT)
    lblOne.tag_configure("ssub",offset=-2.3,font=SMALL_FONT)
    lblOne.tag_configure("sn1",font=LARGE_FONT)
    lblOne.configure(state=tk.DISABLED,borderwidth=-3)
    lblOne.grid(row=0, column=0, padx=5, pady=5)

    lblOneAns = tk.Text(parLab, width=13,height=1)
    lblOneAns.insert(tk.INSERT,str(round(S0,2)))
    lblOneAns.configure(state=tk.DISABLED)
    lblOneAns.grid(row=0, column=1, padx=5, pady=5)

    lblOneUnit = tk.Text(parLab, width=21,height=1,background='snow2')
    lblOneUnit.insert(tk.INSERT, u'\N{GREEK SMALL LETTER MU}g S g-1')
    lblOneUnit.tag_add("sun",'1.0','1.6')
    lblOneUnit.tag_add("susup",'1.6','1.8')
    lblOneUnit.tag_configure("sun",font=LARGE_FONT)
    lblOneUnit.tag_configure("susup",offset=2.3,font=SMALL_FONT)
    lblOneUnit.configure(state=tk.DISABLED,borderwidth=-3)
    lblOneUnit.grid(row=0, column=2, padx=5, pady=5)

    alphaPLab = tk.Text(parLab, width=4,height=1,background='snow2')
    alphaPLab.grid(row=1,column=0,pady=5,padx=5)
    alphaPLab.insert(tk.INSERT,u'\N{GREEK SMALL LETTER ALPHA}')
    alphaPLab.insert(tk.END,"s =")
    alphaPLab.tag_add("san",'1.0','1.1')
    alphaPLab.tag_add("subscript",'1.1','1.2')
    alphaPLab.tag_add("san1",'1.2','1.4')
    alphaPLab.tag_configure("san",font=LARGE_FONT)
    alphaPLab.tag_configure("subscript",offset=-2.3,font=SMALL_FONT)
    alphaPLab.tag_configure("san1",font=LARGE_FONT)
    alphaPLab.configure(state=tk.DISABLED, borderwidth=-3)

        
    alphaPText = tk.Text(parLab, width=13, height=1)
    alphaPText.grid(row=1,column=1,padx=5,pady=5)
    alphaPText.insert(tk.INSERT,'{0:.4f}'.format(alpha*10**4)+' x 10-4')
    alphaPText.tag_add('a','1.11','1.13')
    alphaPText.tag_configure('a',offset=2.3,font=SMALL_FONT)
    alphaPText.configure(state=tk.DISABLED)

    alphaPLabUnit = tk.Text(parLab, width=21,height=1,background='snow2')
    alphaPLabUnit.grid(row=1,column=2,pady=5,padx=5)
    alphaPLabUnit.insert(tk.INSERT,'day-1')
    alphaPLabUnit.tag_add("saun",'1.0','1.3')
    alphaPLabUnit.tag_add("superscript",'1.3','1.5')
    alphaPLabUnit.tag_configure("saun",font=LARGE_FONT)
    alphaPLabUnit.tag_configure("superscript",offset=2.3,font=SMALL_FONT)
    alphaPLabUnit.configure(state=tk.DISABLED, borderwidth=-3)


    lblThree = tk.Text(parLab, width=4,height=1,background='snow2')
    lblThree.insert(tk.INSERT,'cs =')
    lblThree.tag_add("csn",'1.0','1.1')
    lblThree.tag_add("csub",'1.1','1.2')
    lblThree.tag_add("csn1",'1.2','1.4')
    lblThree.tag_configure("csn",font=LARGE_FONT)
    lblThree.tag_configure("csub",offset=-2.3,font=SMALL_FONT)
    lblThree.tag_configure("csn1",font=LARGE_FONT)
    lblThree.configure(state=tk.DISABLED,borderwidth=-3)
    lblThree.grid(row=2, column=0, padx=5, pady=5)

    
    lblThreeAns = tk.Text(parLab, width=13,height=1)
    lblThreeAns.insert(tk.INSERT,str(round(c,4)))
    lblThreeAns.configure(state=tk.DISABLED)
    lblThreeAns.grid(row=2, column=1, padx=5, pady=5)

    lblThreeUnit = tk.Text(parLab, width=21,height=1,background='snow2')
    lblThreeUnit.insert(tk.INSERT, 'EOS (kg S ha-1)-1')
    lblThreeUnit.tag_add("cusn",'1.0','1.12')
    lblThreeUnit.tag_add("cusup1",'1.12','1.14')
    lblThreeUnit.tag_add("cusn1",'1.14','1.15')
    lblThreeUnit.tag_add("cusup2",'1.15','1.17')
    lblThreeUnit.tag_configure("cusn",font=LARGE_FONT)
    lblThreeUnit.tag_configure("cusup1",offset=2.3,font=SMALL_FONT)
    lblThreeUnit.tag_configure("cusn1",font=LARGE_FONT)
    lblThreeUnit.tag_configure("cusup2",offset=2.3,font=SMALL_FONT)
    lblThreeUnit.configure(state=tk.DISABLED,borderwidth=-3)
    lblThreeUnit.grid(row=2, column=2, padx=5, pady=5)

    
    rySConsts = np.array([183.80, 0.09, 10.49])
    

    
    fig = Figure(figsize=(5,6), dpi=80)
    a = fig.add_subplot(211)
    a.axis([TObs[0]/365, TObs[-1]/365 + 0.5, 0, max(max(Obs1),max(Obs2),max(Obs3),max(Obs4),max(Obs5),max(Obs6),max(pk6)) + 5])
    a.xaxis.set_major_formatter(matplotlib.ticker.FormatStrFormatter('%.0f'))
    a.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=True))
    a.set_ylabel('EOS')
    b = fig.add_subplot(212)
    b.axis([TObs[0]/365, TObs[-1]/365 + 0.5, 50, 105])
    b.xaxis.set_major_formatter(matplotlib.ticker.FormatStrFormatter('%.0f'))
    b.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(integer=True))
    b.set_ylabel('RY')
    b.set_xlabel('Years')
            
    a.plot(t/365, pk1, 'r', TObs/365, Obs1, 'r^', t/365, pk2, 'b', TObs/365, Obs2, 'b^', t/365, pk3, 'g', TObs/365, Obs3, 'g^', t/365, pk4, 'y', TObs/365, Obs4, 'y^', t/365, pk5, 'm', TObs/365, Obs5, 'm^', t/365, pk6, 'c', TObs/365, Obs6, 'c^')
    ry1 = rYieldFunc(t,pk1,rySConsts)
    ry2 = rYieldFunc(t,pk2,rySConsts)
    ry3 = rYieldFunc(t,pk3,rySConsts)
    ry4 = rYieldFunc(t,pk4,rySConsts)
    ry5 = rYieldFunc(t,pk5,rySConsts)
    ry6 = rYieldFunc(t,pk6,rySConsts)
    b.plot(t/365,ry1,'r',t/365,ry2,'b', t/365, ry3, 'g', t/365, ry4, 'y', t/365, ry5, 'm', t/365, ry6, 'c')
    canvas = FigureCanvasTkAgg(fig, frame)
    canvas.show()
    canvas.get_tk_widget().grid(row=0, column=0, columnspan=1, padx=10, pady=10, sticky='nsew')
    popup.mainloop()
